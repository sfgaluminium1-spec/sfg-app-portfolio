{
  "app_name": "ChronoShift Pro",
  "app_id": "chronoshift-pro",
  "version": "2.3.0",
  "category": "sfg-aluminium-app",
  "status": "production",
  "deployment": {
    "production_url": "https://chronoshift-pro.abacusai.app",
    "health_check": "https://chronoshift-pro.abacusai.app/api/health",
    "webhook_url": "https://chronoshift-pro.abacusai.app/api/webhooks/nexus",
    "message_handler_url": "https://chronoshift-pro.abacusai.app/api/messages/handle"
  },
  "webhook_events": [
    "employee.registered",
    "employee.updated",
    "payroll.process_requested",
    "timesheet.bulk_import",
    "compliance.audit_required",
    "test.event"
  ],
  "supported_messages": [
    "query.employee_data",
    "query.timesheet_summary",
    "query.payroll_summary",
    "action.approve_timesheet",
    "action.generate_payslip",
    "action.export_payroll_data",
    "test.message"
  ],
  "purpose": "Professional payroll and timesheet management system with location tracking, supervisor approvals, and Microsoft 365 integration for SFG Aluminium Ltd",
  "tech_stack": {
    "framework": "Next.js 14.2.28",
    "language": "TypeScript 5.2.2",
    "database": "PostgreSQL",
    "orm": "Prisma 6.7.0",
    "auth": "NextAuth.js 4.24.11",
    "ui": "React 18.2.0 + Tailwind CSS + shadcn/ui"
  },
  "capabilities": [
    "Employee timesheet management with GPS location verification",
    "Supervisor approval workflows with 24-hour SLA",
    "Automated payroll calculations (UK compliance)",
    "Microsoft 365 SSO (Entra ID authentication)",
    "SharePoint document management integration",
    "Microsoft Teams embedded app with bot commands",
    "External app integration ecosystem with AI analysis",
    "Mobile PWA with offline sync",
    "7-year audit trail for UK employment law",
    "Geofence location tracking with Haversine distance",
    "Late submission penalty enforcement",
    "GDPR compliance with data deletion",
    "Role-based access control (Employee/Supervisor/Admin)",
    "Weekly payroll export to BrightPay",
    "WhatsApp Business notifications via Twilio"
  ],
  "workflows": [
    {
      "name": "Timesheet Submission and Approval",
      "steps": [
        "Employee submits timesheet with GPS location",
        "System verifies location against home postcode (5km radius)",
        "Timesheet marked as SUBMITTED and enters approval queue",
        "Supervisor receives notification (24-hour SLA starts)",
        "Supervisor reviews and approves/rejects",
        "Employee receives notification of decision",
        "Approved timesheets are included in weekly payroll export"
      ]
    },
    {
      "name": "Weekly Payroll Processing",
      "steps": [
        "System checks for late timesheet submissions (after Tuesday 5 PM)",
        "Late submissions receive default 42.5 hours (no overtime)",
        "Approved timesheets are aggregated by employee",
        "Payroll calculations applied (regular + 1.5x overtime)",
        "Export generated in BrightPay format (Excel)",
        "Export sent to HR administrator",
        "Payroll data archived in SharePoint"
      ]
    },
    {
      "name": "Employee Onboarding",
      "steps": [
        "Admin creates employee record (SFG number, contact, role)",
        "Microsoft 365 account created or linked",
        "SharePoint employee folder created",
        "Employee receives login credentials",
        "First timesheet submitted within 2 days",
        "Audit log entry created"
      ]
    }
  ],
  "business_rules": [
    {
      "rule": "Geofence location verification",
      "condition": "distance <= 5000 meters",
      "action": "Mark timesheet location as verified"
    },
    {
      "rule": "Late timesheet submission penalty",
      "condition": "submission_time > Tuesday 17:00 Europe/London",
      "action": "Default to 42.5 hours regular, 0 overtime"
    },
    {
      "rule": "Supervisor approval SLA",
      "condition": "time_since_submission > 24 hours",
      "action": "Escalate to admin, send reminder notification"
    },
    {
      "rule": "Overtime calculation",
      "condition": "total_hours > 42.5",
      "action": "Pay overtime hours at 1.5x hourly rate"
    },
    {
      "rule": "Extended shift calculation (Nights/Weekends)",
      "condition": "shift_type == 'extended'",
      "action": "28 hours total - 8 hours sleep = 20 hours paid (11.5 regular + 8.5 overtime weekday, 20 overtime weekend)"
    }
  ],
  "integrations": [
    {
      "system": "Microsoft 365 (Entra ID)",
      "purpose": "SSO authentication",
      "status": "production"
    },
    {
      "system": "Microsoft SharePoint",
      "purpose": "Document storage and archival",
      "status": "production"
    },
    {
      "system": "Microsoft Teams",
      "purpose": "Notifications and embedded app",
      "status": "production"
    },
    {
      "system": "BrightPay",
      "purpose": "Weekly payroll export",
      "status": "production"
    },
    {
      "system": "Twilio (WhatsApp Business)",
      "purpose": "Timesheet reminders and notifications",
      "status": "configured"
    },
    {
      "system": "NEXUS Orchestration System",
      "purpose": "Event-driven integration with SFG ecosystem",
      "status": "registered"
    }
  ],
  "api_endpoints": [
    {
      "path": "/api/health",
      "method": "GET",
      "description": "Application health check",
      "auth_required": false
    },
    {
      "path": "/api/timesheets",
      "method": "GET",
      "description": "Retrieve employee timesheets",
      "auth_required": true
    },
    {
      "path": "/api/timesheets",
      "method": "POST",
      "description": "Create new timesheet entry",
      "auth_required": true
    },
    {
      "path": "/api/timesheets/:id/approve",
      "method": "POST",
      "description": "Approve timesheet (supervisor/admin only)",
      "auth_required": true
    },
    {
      "path": "/api/employees",
      "method": "GET",
      "description": "List all employees (admin only)",
      "auth_required": true
    },
    {
      "path": "/api/export/timesheets",
      "method": "GET",
      "description": "Export approved timesheets for BrightPay",
      "auth_required": true
    },
    {
      "path": "/api/webhooks/nexus",
      "method": "POST",
      "description": "NEXUS webhook receiver",
      "auth_required": false,
      "signature_verification": true
    },
    {
      "path": "/api/messages/handle",
      "method": "POST",
      "description": "NEXUS message handler",
      "auth_required": false
    }
  ],
  "rbac": {
    "tier3_employee": [
      "create_own_timesheet",
      "view_own_payslips",
      "submit_timesheet"
    ],
    "tier2_supervisor": [
      "approve_department_timesheets",
      "view_department_employees",
      "review_location_failures"
    ],
    "tier1_admin": [
      "full_access",
      "manage_employees",
      "export_payroll",
      "manage_integrations",
      "access_audit_logs"
    ]
  },
  "compliance": {
    "gdpr_compliance": true,
    "uk_employment_law": true,
    "audit_log_retention_years": 7,
    "data_encryption": "AES-256-GCM",
    "session_timeout_minutes": 15
  },
  "registration_date": "2025-11-06",
  "last_updated": "2025-11-06",
  "registered_by": "Warren Heathcote (via DeepAgent)"
}
