exports.id=4913,exports.ids=[4913],exports.modules={41282:(e,r,s)=>{Promise.resolve().then(s.bind(s,34166)),Promise.resolve().then(s.bind(s,51726)),Promise.resolve().then(s.bind(s,90343)),Promise.resolve().then(s.t.bind(s,95003,23))},68744:(e,r,s)=>{Promise.resolve().then(s.bind(s,75282))},87133:(e,r,s)=>{Promise.resolve().then(s.t.bind(s,84114,23)),Promise.resolve().then(s.t.bind(s,28866,23)),Promise.resolve().then(s.t.bind(s,31324,23)),Promise.resolve().then(s.t.bind(s,83567,23)),Promise.resolve().then(s.t.bind(s,55996,23)),Promise.resolve().then(s.t.bind(s,10050,23))},34166:(e,r,s)=>{"use strict";s.d(r,{Header:()=>j});var t=s(62901),a=s(24383),i=s(62392),l=s(84700),n=s(27878),o=s(250),c=s(33901),d=s(32317),m=s(7070),u=s(21680),f=s(16501),h=s(91464),x=s(91046),p=s(34400),b=s(67935),g=s(25650),v=s(77185);function j(){let{data:e}=(0,l.useSession)(),[r,s]=(0,a.useState)(""),j=[{href:"/dashboard",label:"Dashboard",icon:c.Z},{href:"/procedures",label:"Procedures",icon:d.Z},{href:"/categories",label:"Categories",icon:m.Z},{href:"/conflicts",label:"Conflicts",icon:u.Z},{href:"/chat",label:"AI Assistant",icon:f.Z},{href:"/import",label:"Import",icon:h.Z}];return t.jsx("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,t.jsxs)("div",{className:"container mx-auto max-w-7xl flex h-14 items-center px-4",children:[t.jsx("div",{className:"flex items-center space-x-4",children:(0,t.jsxs)(i.default,{href:"/dashboard",className:"flex items-center space-x-2",children:[t.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded bg-primary text-primary-foreground",children:t.jsx(m.Z,{className:"h-4 w-4"})}),t.jsx("span",{className:"hidden font-bold sm:inline-block",children:"CompanyWiki"})]})}),t.jsx("nav",{className:"flex items-center space-x-1 ml-6",children:j.map(e=>{let r=e.icon;return t.jsx(i.default,{href:e.href,children:(0,t.jsxs)(n.z,{variant:"ghost",size:"sm",className:"flex items-center gap-2",children:[t.jsx(r,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden md:inline",children:e.label})]})},e.href)})}),t.jsx("div",{className:"flex-1 flex justify-center px-4",children:t.jsx("form",{onSubmit:e=>{e.preventDefault(),r.trim()&&(window.location.href=`/search?q=${encodeURIComponent(r)}`)},className:"w-full max-w-sm",children:(0,t.jsxs)("div",{className:"relative",children:[t.jsx(x.Z,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),t.jsx(o.I,{placeholder:"Search procedures, policies...",value:r,onChange:e=>s(e.target.value),className:"pl-8"})]})})}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[t.jsx(i.default,{href:"/conflicts",children:t.jsx(n.z,{variant:"ghost",size:"icon",className:"relative",children:t.jsx(p.Z,{className:"h-4 w-4"})})}),t.jsx(i.default,{href:"/settings",children:t.jsx(n.z,{variant:"ghost",size:"icon",children:t.jsx(b.Z,{className:"h-4 w-4"})})}),e?(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)("div",{className:"hidden sm:block text-sm",children:[t.jsx("div",{className:"font-medium",children:e.user.name||e.user.email}),t.jsx("div",{className:"text-muted-foreground text-xs",children:e.user.role})]}),t.jsx(n.z,{variant:"ghost",size:"icon",onClick:()=>(0,l.signOut)({callbackUrl:"/login"}),children:t.jsx(g.Z,{className:"h-4 w-4"})})]}):t.jsx(i.default,{href:"/login",children:t.jsx(n.z,{variant:"ghost",size:"icon",children:t.jsx(v.Z,{className:"h-4 w-4"})})})]})]})})}},51726:(e,r,s)=>{"use strict";s.d(r,{Sidebar:()=>P});var t=s(62901),a=s(24383),i=s(62392),l=s(84374),n=s(27878),o=s(24279),c=s(33901),d=s(63545),m=s(32317),u=s(7070),f=s(21680),h=s(75811),x=s(23468),p=s(91046),b=s(66843),g=s(76244),v=s(44928),j=s(79357),N=s(28462),y=s(64093),w=s(16501),Z=s(79046),k=s(91464),A=s(61989),S=s(67935),C=s(7259),_=s(60004);let E=[{title:"Overview",items:[{href:"/dashboard",label:"Dashboard",icon:c.Z},{href:"/dashboard/projects",label:"Projects",icon:d.Z},{href:"/procedures",label:"All Procedures",icon:m.Z},{href:"/categories",label:"Categories",icon:u.Z},{href:"/conflicts",label:"Conflicts",icon:f.Z}]},{title:"System Control",items:[{href:"/system-overview",label:"System Overview",icon:h.Z},{href:"/process-control",label:"Process Control",icon:x.Z},{href:"/credit-checker",label:"Credit Checker",icon:p.Z}]},{title:"External Integrations",items:[{href:"/company-intelligence",label:"Company Intelligence",icon:p.Z},{href:"/sharepoint-docs",label:"SharePoint Documents",icon:m.Z},{href:"/knowledge-smelter",label:"Knowledge Smelter",icon:u.Z}]},{title:"Company Data",items:[{href:"/staff-tiers",label:"Staff Tiers",icon:b.Z},{href:"/customer-tiers",label:"Customer Tiers",icon:g.Z},{href:"/credit-checks",label:"Credit Checks",icon:v.Z},{href:"/pricing-rules",label:"Pricing & Margins",icon:j.Z},{href:"/payroll-formulas",label:"Payroll Formulas",icon:N.Z},{href:"/project-numbering",label:"Project Numbers",icon:y.Z}]},{title:"Tools",items:[{href:"/chat",label:"AI Assistant",icon:w.Z},{href:"/prompt-library",label:"Prompt Library",icon:Z.Z},{href:"/import",label:"Import Data",icon:k.Z},{href:"/workflows",label:"Workflow Diagrams",icon:A.Z}]},{title:"Administration",items:[{href:"/audit-logs",label:"Audit Trail",icon:m.Z},{href:"/users",label:"User Management",icon:b.Z},{href:"/settings",label:"Settings",icon:S.Z}]}];function P(){let e=(0,l.usePathname)(),[r,s]=(0,a.useState)(["Overview","System Control","External Integrations","Company Data"]),c=e=>{s(r=>r.includes(e)?r.filter(r=>r!==e):[...r,e])};return t.jsx("div",{className:"flex h-full w-64 flex-col border-r bg-muted/40",children:t.jsx(o.x,{className:"flex-1 px-3 py-4",children:t.jsx("div",{className:"space-y-4",children:E.map(s=>(0,t.jsxs)("div",{children:[(0,t.jsxs)(n.z,{variant:"ghost",size:"sm",className:"w-full justify-start px-2 font-semibold text-muted-foreground hover:text-foreground",onClick:()=>c(s.title),children:[r.includes(s.title)?t.jsx(C.Z,{className:"mr-2 h-4 w-4"}):t.jsx(_.Z,{className:"mr-2 h-4 w-4"}),s.title]}),r.includes(s.title)&&t.jsx("div",{className:"mt-2 space-y-1",children:s.items.map(r=>{let s=r.icon,a=e===r.href;return t.jsx(i.default,{href:r.href,children:(0,t.jsxs)(n.z,{variant:a?"secondary":"ghost",size:"sm",className:"w-full justify-start pl-8",children:[t.jsx(s,{className:"mr-2 h-4 w-4"}),t.jsx("span",{className:"flex-1 text-left",children:r.label})]})},r.href)})})]},s.title))})})})}},75282:(e,r,s)=>{"use strict";s.d(r,{Providers:()=>m});var t,a=s(62901),i=s(84700);s(24383);var l=s(69878);function n({children:e,...r}){return a.jsx(l.f,{...r,children:e})}var o=s(43921);let c=({...e})=>{let{theme:r="system"}=(0,l.F)();return a.jsx(o.x7,{theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};function d({children:e,className:r=""}){let{data:s}=(0,i.useSession)()||{},l=(()=>{if(!s?.user)return"sales";let e=s.user.tierLevel;return e===t.CEO||"SUPER_ADMIN"===s.user.role?"ceo":e===t.FINANCE||"ADMIN"===s.user.role?"finance":"sales"})();return a.jsx("div",{"data-tier":l,className:r,children:e})}function m({children:e}){return a.jsx(i.SessionProvider,{children:a.jsx(n,{attribute:"class",defaultTheme:"dark",enableSystem:!1,disableTransitionOnChange:!0,children:(0,a.jsxs)(d,{children:[e,a.jsx(c,{position:"top-right"})]})})})}!function(e){e.CEO="CEO",e.FINANCE="FINANCE",e.SALES="SALES"}(t||(t={}))},90343:(e,r,s)=>{"use strict";s.d(r,{AnimatedBackground:()=>i});var t=s(62901),a=s(24383);function i(){let e=(0,a.useRef)(null);return t.jsx("canvas",{ref:e,className:"fixed inset-0 pointer-events-none",style:{zIndex:0}})}},27878:(e,r,s)=>{"use strict";s.d(r,{z:()=>c});var t=s(62901),a=s(24383),i=s(42049),l=s(47279),n=s(68637);let o=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef(({className:e,variant:r,size:s,asChild:a=!1,...l},c)=>{let d=a?i.g7:"button";return t.jsx(d,{className:(0,n.cn)(o({variant:r,size:s,className:e})),ref:c,...l})});c.displayName="Button"},250:(e,r,s)=>{"use strict";s.d(r,{I:()=>l});var t=s(62901),a=s(24383),i=s(68637);let l=a.forwardRef(({className:e,type:r,...s},a)=>t.jsx("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...s}));l.displayName="Input"},24279:(e,r,s)=>{"use strict";s.d(r,{x:()=>n});var t=s(62901),a=s(24383),i=s(82477),l=s(68637);let n=a.forwardRef(({className:e,children:r,...s},a)=>(0,t.jsxs)(i.fC,{ref:a,className:(0,l.cn)("relative overflow-hidden",e),...s,children:[t.jsx(i.l_,{className:"h-full w-full rounded-[inherit]",children:r}),t.jsx(o,{}),t.jsx(i.Ns,{})]}));n.displayName=i.fC.displayName;let o=a.forwardRef(({className:e,orientation:r="vertical",...s},a)=>t.jsx(i.gb,{ref:a,orientation:r,className:(0,l.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...s,children:t.jsx(i.q4,{className:"relative flex-1 rounded-full bg-border"})}));o.displayName=i.gb.displayName},68637:(e,r,s)=>{"use strict";s.d(r,{cn:()=>i});var t=s(84330),a=s(77189);function i(...e){return(0,a.m6)((0,t.W)(e))}},21769:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>f});var t=s(83537),a=s(57978),i=s(15438),l=s(11826),n=s(88895);let o=(0,n.createProxy)(String.raw`/home/ubuntu/company_wiki/nextjs_space/components/layout/header.tsx#Header`),c=(0,n.createProxy)(String.raw`/home/ubuntu/company_wiki/nextjs_space/components/layout/sidebar.tsx#Sidebar`);var d=s(85168);function m(){return t.jsx("footer",{className:"border-t border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:t.jsx("div",{className:"container mx-auto max-w-7xl px-6 py-4",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 text-sm text-muted-foreground",children:[t.jsx("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("span",{children:["\xa9 ",new Date().getFullYear()," SFG Aluminium Limited. All rights reserved."]})}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[t.jsx(d.default,{href:"/privacy",className:"hover:text-primary transition-colors",children:"Privacy Notice"}),t.jsx("span",{children:"â€¢"}),t.jsx(d.default,{href:"/terms",className:"hover:text-primary transition-colors",children:"Terms of Use"})]})]})})})}let u=(0,n.createProxy)(String.raw`/home/ubuntu/company_wiki/nextjs_space/components/ui/animated-background.tsx#AnimatedBackground`);async function f({children:e}){return await (0,a.getServerSession)(l.L)||(0,i.redirect)("/login"),(0,t.jsxs)("div",{className:"min-h-screen bg-background relative flex flex-col",children:[t.jsx(u,{}),(0,t.jsxs)("div",{className:"relative z-10 flex-1 flex flex-col",children:[t.jsx(o,{}),(0,t.jsxs)("div",{className:"flex flex-1 h-[calc(100vh-7rem)]",children:[t.jsx(c,{}),t.jsx("main",{className:"flex-1 overflow-auto",children:t.jsx("div",{className:"container mx-auto max-w-7xl p-6",children:e})})]}),t.jsx(m,{})]})]})}},70443:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>o,metadata:()=>n});var t=s(83537),a=s(57416),i=s.n(a);s(26148);let l=(0,s(88895).createProxy)(String.raw`/home/ubuntu/company_wiki/nextjs_space/components/providers.tsx#Providers`),n={title:"SFG Aluminium Wiki - Knowledge Management System",description:"Comprehensive company knowledge management, operational procedures, and RAG-enabled wiki system for SFG Aluminium",icons:{icon:"/favicon.svg",shortcut:"/favicon.svg"}};function o({children:e}){return t.jsx("html",{lang:"en",children:t.jsx("body",{className:i().className,children:t.jsx(l,{children:e})})})}},11826:(e,r,s)=>{"use strict";s.d(r,{L:()=>d});var t=s(64617),a=s(66291),i=s(80207),l=s(3390),n=s.n(l),o=s(83178);let c=[(0,a.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let r=await o._.user.findUnique({where:{email:e.email}});return r&&r.password&&await n().compare(e.password,r.password)?{id:r.id,email:r.email,name:r.firstName?`${r.firstName} ${r.lastName||""}`.trim():r.email,role:r.role}:null}})];process.env.AZURE_AD_CLIENT_ID&&process.env.AZURE_AD_CLIENT_SECRET&&process.env.AZURE_AD_TENANT_ID&&c.push((0,i.Z)({clientId:process.env.AZURE_AD_CLIENT_ID,clientSecret:process.env.AZURE_AD_CLIENT_SECRET,tenantId:process.env.AZURE_AD_TENANT_ID,authorization:{params:{scope:"openid profile email User.Read"}}}));let d={adapter:(0,t.N)(o._),providers:c,session:{strategy:"jwt"},pages:{signIn:"/login"},callbacks:{async signIn({user:e,account:r,profile:s}){if(r?.provider==="azure-ad")try{await o._.user.findUnique({where:{email:e.email}})||await o._.user.create({data:{email:e.email,firstName:s?.given_name||e.name?.split(" ")[0]||"",lastName:s?.family_name||e.name?.split(" ").slice(1).join(" ")||"",role:"USER",password:null}})}catch(e){return console.error("Error during Azure AD sign-in:",e),!1}return!0},jwt:async({token:e,user:r,account:s,profile:t})=>(r&&(e.role=r.role),s?.provider==="azure-ad"&&t&&(e.groups=t.groups||[],t.roles&&(t.roles.includes("SFG-Wiki-Admin")?e.role="ADMIN":t.roles.includes("SFG-Wiki-Approver")?e.role="APPROVER":t.roles.includes("SFG-Wiki-Editor")?e.role="EDITOR":t.roles.includes("SFG-Wiki-Viewer")&&(e.role="USER"))),e),session:async({session:e,token:r})=>(r&&(e.user.id=r.sub,e.user.role=r.role,e.user.groups=r.groups||[]),e)}}},83178:(e,r,s)=>{"use strict";s.d(r,{_:()=>a});var t=s(53524);let a=globalThis.prisma??new t.PrismaClient},26148:()=>{}};