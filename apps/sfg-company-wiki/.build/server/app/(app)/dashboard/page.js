(()=>{var e={};e.id=40,e.ids=[40],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},86624:e=>{"use strict";e.exports=require("querystring")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},60627:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>d,routeModule:()=>p,tree:()=>c}),t(13441),t(21769),t(71363),t(70443);var s=t(36576),a=t(72007),i=t(21818),n=t.n(i),l=t(88897),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(r,o);let c=["",{children:["(app)",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,13441)),"/home/ubuntu/company_wiki/nextjs_space/app/(app)/dashboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,21769)),"/home/ubuntu/company_wiki/nextjs_space/app/(app)/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,71363,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,70443)),"/home/ubuntu/company_wiki/nextjs_space/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,71363,23)),"next/dist/client/components/not-found-error"]}],d=["/home/ubuntu/company_wiki/nextjs_space/app/(app)/dashboard/page.tsx"],m="/(app)/dashboard/page",u={require:t,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(app)/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},3605:(e,r,t)=>{Promise.resolve().then(t.bind(t,55851)),Promise.resolve().then(t.bind(t,68701)),Promise.resolve().then(t.t.bind(t,95003,23))},55851:(e,r,t)=>{"use strict";t.d(r,{RulesValidator:()=>f});var s=t(62901),a=t(24383),i=t(68701),n=t(27878),l=t(250),o=t(74128),c=t(72388),d=t(558),m=t(21680),u=t(61659);let p={supplyAndInstall:{target:45,minimum:28,type:"Supply & Install"},supplyOnly:{target:30,minimum:28,type:"Supply Only"},maintenance:{base:10,markup:20,minimum:28,type:"Maintenance & Repair"},corporate:{target:55,minimum:28,type:"Corporate Contract"}},x={junior:{name:"Junior Estimator",approvalLimit:1e3,level:1,permissions:["view_enquiries","create_enquiries"]},standard:{name:"Estimator",approvalLimit:5e3,level:2,permissions:["view_enquiries","create_enquiries","edit_quotes","view_customers"]},senior:{name:"Senior Estimator",approvalLimit:15e3,level:3,permissions:["view_enquiries","create_enquiries","edit_quotes","view_customers","approve_quotes","credit_checks"]},manager:{name:"Manager",approvalLimit:5e4,level:4,permissions:["all_basic","team_management","override_pricing"]},director:{name:"Director",approvalLimit:1/0,level:5,permissions:["full_access"]}},h={maxWorkHeight:15,maxWorkDepth:2,minSubcontractorPL:5e6},g=["groundwork","excavation","demolition","pile_driving","railway_work","airside_work","offshore_work","power_station_work"];function f(){let[e,r]=(0,a.useState)({}),[t,f]=(0,a.useState)({jobType:"supplyAndInstall",cost:1e4,price:18e3}),[y,j]=(0,a.useState)({amount:5e3,userTier:"standard"}),[v,w]=(0,a.useState)({workHeight:10,workDepth:1,includesGroundwork:!1,workType:[]});return(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[(0,s.jsxs)(i.TransparentCard,{children:[s.jsx(i.TransparentCardHeader,{children:s.jsx(i.TransparentCardTitle,{className:"text-lg",children:"Margin Validator"})}),(0,s.jsxs)(i.TransparentCardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(o._,{htmlFor:"jobType",className:"text-white",children:"Job Type"}),(0,s.jsxs)(c.Ph,{value:t.jobType,onValueChange:e=>f(r=>({...r,jobType:e})),children:[s.jsx(c.i4,{id:"jobType",className:"bg-white/10 text-white border-white/20",children:s.jsx(c.ki,{})}),s.jsx(c.Bw,{children:Object.entries(p).map(([e,r])=>s.jsx(c.Ql,{value:e,children:r.type},e))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(o._,{htmlFor:"cost",className:"text-white",children:"Cost (\xa3)"}),s.jsx(l.I,{id:"cost",type:"number",value:t.cost,onChange:e=>f(r=>({...r,cost:parseFloat(e.target.value)||0})),className:"bg-white/10 text-white border-white/20"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(o._,{htmlFor:"price",className:"text-white",children:"Price (\xa3)"}),s.jsx(l.I,{id:"price",type:"number",value:t.price,onChange:e=>f(r=>({...r,price:parseFloat(e.target.value)||0})),className:"bg-white/10 text-white border-white/20"})]}),s.jsx(n.z,{onClick:()=>{let e=function(e,r,t){let s=p[e],a=(t-r)/t*100,i="target"in s?s.target:s.base+s.markup,n=s.minimum,l="ok",o=`Margin ${a.toFixed(1)}% is within target range`;return a<n?(l="critical",o=`ðŸš¨ BLOCKED: Margin ${a.toFixed(1)}% is below absolute minimum ${n}%. Director approval required.`):a<i&&(l="warning",o=`âš ï¸ WARNING: Margin ${a.toFixed(1)}% is below target ${i}%. Consider repricing.`),{isValid:a>=n,margin:a,targetMargin:i,minimumMargin:n,variance:a-i,severity:l,message:o}}(t.jobType,t.cost,t.price);r(r=>({...r,margin:e}))},className:"w-full",children:"Validate Margin"}),e.margin&&s.jsx("div",{className:`p-4 rounded-lg ${"ok"===e.margin.severity?"bg-green-500/20 border border-green-500/50":"warning"===e.margin.severity?"bg-yellow-500/20 border border-yellow-500/50":"bg-red-500/20 border border-red-500/50"}`,children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:["ok"===e.margin.severity&&s.jsx(d.Z,{className:"h-5 w-5 text-green-400 mt-0.5"}),"warning"===e.margin.severity&&s.jsx(m.Z,{className:"h-5 w-5 text-yellow-400 mt-0.5"}),"critical"===e.margin.severity&&s.jsx(u.Z,{className:"h-5 w-5 text-red-400 mt-0.5"}),(0,s.jsxs)("div",{className:"flex-1 text-sm text-white",children:[(0,s.jsxs)("p",{className:"font-semibold",children:["Margin: ",e.margin.margin.toFixed(1),"%"]}),s.jsx("p",{className:"text-white/80 mt-1",children:e.margin.message})]})]})})]})]}),(0,s.jsxs)(i.TransparentCard,{children:[s.jsx(i.TransparentCardHeader,{children:s.jsx(i.TransparentCardTitle,{className:"text-lg",children:"Credit Approval"})}),(0,s.jsxs)(i.TransparentCardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(o._,{htmlFor:"amount",className:"text-white",children:"Amount (\xa3)"}),s.jsx(l.I,{id:"amount",type:"number",value:y.amount,onChange:e=>j(r=>({...r,amount:parseFloat(e.target.value)||0})),className:"bg-white/10 text-white border-white/20"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(o._,{htmlFor:"userTier",className:"text-white",children:"Your Staff Tier"}),(0,s.jsxs)(c.Ph,{value:y.userTier,onValueChange:e=>j(r=>({...r,userTier:e})),children:[s.jsx(c.i4,{id:"userTier",className:"bg-white/10 text-white border-white/20",children:s.jsx(c.ki,{})}),s.jsx(c.Bw,{children:Object.entries(x).map(([e,r])=>(0,s.jsxs)(c.Ql,{value:e,children:[r.name," (\xa3",r.approvalLimit===1/0?"Unlimited":r.approvalLimit.toLocaleString(),")"]},e))})]})]}),s.jsx(n.z,{onClick:()=>{let e=function(e,r){let t=x[r],s=e<=t.approvalLimit,a="junior";for(let[r,t]of Object.entries(x))if(e<=t.approvalLimit){a=r;break}return{requiresApproval:!0,minimumStaffTier:a,canCurrentUserApprove:s,escalationRequired:!s,message:s?`âœ… You can approve this (\xa3${e.toLocaleString()})`:`âš ï¸ Escalation required to ${x[a].name} (\xa3${e.toLocaleString()} exceeds your \xa3${t.approvalLimit.toLocaleString()} limit)`}}(y.amount,y.userTier);r(r=>({...r,credit:e}))},className:"w-full",children:"Check Approval"}),e.credit&&s.jsx("div",{className:`p-4 rounded-lg ${e.credit.canCurrentUserApprove?"bg-green-500/20 border border-green-500/50":"bg-yellow-500/20 border border-yellow-500/50"}`,children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[e.credit.canCurrentUserApprove?s.jsx(d.Z,{className:"h-5 w-5 text-green-400 mt-0.5"}):s.jsx(m.Z,{className:"h-5 w-5 text-yellow-400 mt-0.5"}),s.jsx("p",{className:"flex-1 text-sm text-white",children:e.credit.message})]})})]})]}),(0,s.jsxs)(i.TransparentCard,{children:[s.jsx(i.TransparentCardHeader,{children:s.jsx(i.TransparentCardTitle,{className:"text-lg",children:"Insurance Check"})}),(0,s.jsxs)(i.TransparentCardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(o._,{htmlFor:"workHeight",className:"text-white",children:"Work Height (m)"}),s.jsx(l.I,{id:"workHeight",type:"number",value:v.workHeight,onChange:e=>w(r=>({...r,workHeight:parseFloat(e.target.value)||0})),className:"bg-white/10 text-white border-white/20"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(o._,{htmlFor:"workDepth",className:"text-white",children:"Work Depth (m)"}),s.jsx(l.I,{id:"workDepth",type:"number",value:v.workDepth,onChange:e=>w(r=>({...r,workDepth:parseFloat(e.target.value)||0})),className:"bg-white/10 text-white border-white/20"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{id:"groundwork",type:"checkbox",checked:v.includesGroundwork,onChange:e=>w(r=>({...r,includesGroundwork:e.target.checked})),className:"h-4 w-4"}),s.jsx(o._,{htmlFor:"groundwork",className:"text-white cursor-pointer",children:"Includes Groundwork"})]}),s.jsx(n.z,{onClick:()=>{let e=function(e){let r=[],t=[];e.workHeight&&e.workHeight>h.maxWorkHeight&&r.push(`ðŸš¨ CRITICAL: Work height ${e.workHeight}m exceeds insurance limit of ${h.maxWorkHeight}m (Endorsement 25)`),e.workDepth&&e.workDepth>h.maxWorkDepth&&r.push(`ðŸš¨ CRITICAL: Work depth ${e.workDepth}m exceeds insurance limit of ${h.maxWorkDepth}m (Endorsement 12)`),e.includesGroundwork&&r.push(`ðŸš¨ CRITICAL: Groundwork is explicitly excluded from insurance (Endorsement 60)`);let s=e.workType.filter(e=>g.includes(e));return s.length>0&&r.push(`ðŸš¨ CRITICAL: Prohibited work types detected: ${s.join(", ")} (Hazardous Works Exclusion 593)`),e.subcontractors&&e.subcontractors.forEach(e=>{e.plCover<h.minSubcontractorPL&&r.push(`ðŸš¨ CRITICAL: Subcontractor "${e.name}" has insufficient PL cover (\xa3${e.plCover.toLocaleString()} < required \xa3${h.minSubcontractorPL.toLocaleString()})`)}),e.workHeight&&e.workHeight>.8*h.maxWorkHeight&&t.push(`âš ï¸ Work height ${e.workHeight}m is approaching insurance limit`),{isPermitted:0===r.length,violations:r,warnings:t,requiresSpecialApproval:r.length>0}}(v);r(r=>({...r,insurance:e}))},className:"w-full",children:"Check Insurance"}),e.insurance&&s.jsx("div",{className:`p-4 rounded-lg ${e.insurance.isPermitted?"bg-green-500/20 border border-green-500/50":"bg-red-500/20 border border-red-500/50"}`,children:(0,s.jsxs)("div",{className:"space-y-2",children:[e.insurance.isPermitted?(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[s.jsx(d.Z,{className:"h-5 w-5 text-green-400 mt-0.5"}),s.jsx("p",{className:"flex-1 text-sm text-white font-semibold",children:"âœ… Work is covered by insurance"})]}):s.jsx(s.Fragment,{children:e.insurance.violations.map((e,r)=>(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[s.jsx(u.Z,{className:"h-5 w-5 text-red-400 mt-0.5 flex-shrink-0"}),s.jsx("p",{className:"flex-1 text-xs text-white",children:e})]},r))}),e.insurance.warnings.length>0&&s.jsx("div",{className:"mt-2 pt-2 border-t border-white/20",children:e.insurance.warnings.map((e,r)=>(0,s.jsxs)("div",{className:"flex items-start gap-2 mt-1",children:[s.jsx(m.Z,{className:"h-4 w-4 text-yellow-400 mt-0.5 flex-shrink-0"}),s.jsx("p",{className:"flex-1 text-xs text-white/80",children:e})]},r))})]})})]})]})]})}},74128:(e,r,t)=>{"use strict";t.d(r,{_:()=>d});var s=t(62901),a=t(24383),i=t(74132),n=a.forwardRef((e,r)=>(0,s.jsx)(i.WV.label,{...e,ref:r,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));n.displayName="Label";var l=t(47279),o=t(68637);let c=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=a.forwardRef(({className:e,...r},t)=>s.jsx(n,{ref:t,className:(0,o.cn)(c(),e),...r}));d.displayName=n.displayName},72388:(e,r,t)=>{"use strict";t.d(r,{Bw:()=>h,Ph:()=>d,Ql:()=>g,i4:()=>u,ki:()=>m});var s=t(62901),a=t(24383),i=t(32338),n=t(7259),l=t(26026),o=t(85453),c=t(68637);let d=i.fC;i.ZA;let m=i.B4,u=a.forwardRef(({className:e,children:r,...t},a)=>(0,s.jsxs)(i.xz,{ref:a,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...t,children:[r,s.jsx(i.JO,{asChild:!0,children:s.jsx(n.Z,{className:"h-4 w-4 opacity-50"})})]}));u.displayName=i.xz.displayName;let p=a.forwardRef(({className:e,...r},t)=>s.jsx(i.u_,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",e),...r,children:s.jsx(l.Z,{className:"h-4 w-4"})}));p.displayName=i.u_.displayName;let x=a.forwardRef(({className:e,...r},t)=>s.jsx(i.$G,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",e),...r,children:s.jsx(n.Z,{className:"h-4 w-4"})}));x.displayName=i.$G.displayName;let h=a.forwardRef(({className:e,children:r,position:t="popper",...a},n)=>s.jsx(i.h_,{children:(0,s.jsxs)(i.VY,{ref:n,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===t&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:t,...a,children:[s.jsx(p,{}),s.jsx(i.l_,{className:(0,c.cn)("p-1","popper"===t&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),s.jsx(x,{})]})}));h.displayName=i.VY.displayName,a.forwardRef(({className:e,...r},t)=>s.jsx(i.__,{ref:t,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...r})).displayName=i.__.displayName;let g=a.forwardRef(({className:e,children:r,...t},a)=>(0,s.jsxs)(i.ck,{ref:a,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(i.wU,{children:s.jsx(o.Z,{className:"h-4 w-4"})})}),s.jsx(i.eT,{children:r})]}));g.displayName=i.ck.displayName,a.forwardRef(({className:e,...r},t)=>s.jsx(i.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",e),...r})).displayName=i.Z0.displayName},68701:(e,r,t)=>{"use strict";t.d(r,{TransparentCard:()=>n,TransparentCardContent:()=>c,TransparentCardHeader:()=>l,TransparentCardTitle:()=>o});var s=t(62901);t(24383);var a=t(68637);let i={none:"",light:"bg-white/5 backdrop-blur-sm",medium:"bg-white/10 backdrop-blur-md",heavy:"bg-white/20 backdrop-blur-lg"};function n({children:e,className:r,glassLevel:t="medium",...n}){return s.jsx("div",{className:(0,a.cn)("rounded-lg border border-white/10 shadow-xl",i[t],r),...n,children:e})}function l({children:e,className:r,...t}){return s.jsx("div",{className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...t,children:e})}function o({children:e,className:r,...t}){return s.jsx("h3",{className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight text-white",r),...t,children:e})}function c({children:e,className:r,...t}){return s.jsx("div",{className:(0,a.cn)("p-6 pt-0",r),...t,children:e})}},558:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});let s=(0,t(71945).Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},61659:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});let s=(0,t(71945).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},13441:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>M});var s=t(83537),a=t(57978),i=t(11826),n=t(83178),l=t(88895);let o=(0,l.createProxy)(String.raw`/home/ubuntu/company_wiki/nextjs_space/components/ui/transparent-card.tsx#TransparentCard`),c=(0,l.createProxy)(String.raw`/home/ubuntu/company_wiki/nextjs_space/components/ui/transparent-card.tsx#TransparentCardHeader`),d=(0,l.createProxy)(String.raw`/home/ubuntu/company_wiki/nextjs_space/components/ui/transparent-card.tsx#TransparentCardTitle`);(0,l.createProxy)(String.raw`/home/ubuntu/company_wiki/nextjs_space/components/ui/transparent-card.tsx#TransparentCardDescription`);let m=(0,l.createProxy)(String.raw`/home/ubuntu/company_wiki/nextjs_space/components/ui/transparent-card.tsx#TransparentCardContent`);(0,l.createProxy)(String.raw`/home/ubuntu/company_wiki/nextjs_space/components/ui/transparent-card.tsx#TransparentCardFooter`);var u=t(31376),p=t(27244),x=t(66809),h=t(25201),g=t(47615),f=t(79118),y=t(89004);let j=(0,y.Z)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var v=t(34241);let w=(0,y.Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);var b=t(7649),N=t(61996),k=t(61112),C=t(86132),_=t(85168);let T=(0,l.createProxy)(String.raw`/home/ubuntu/company_wiki/nextjs_space/components/rules-validator.tsx#RulesValidator`),Z={monthlyTurnover:178571,dailyTurnover:8929,targetMarginMax:45,absoluteMinimumMargin:28},L={junior:{name:"Junior Estimator",approvalLimit:1e3,level:1,permissions:["view_enquiries","create_enquiries"]},standard:{name:"Estimator",approvalLimit:5e3,level:2,permissions:["view_enquiries","create_enquiries","edit_quotes","view_customers"]},senior:{name:"Senior Estimator",approvalLimit:15e3,level:3,permissions:["view_enquiries","create_enquiries","edit_quotes","view_customers","approve_quotes","credit_checks"]},manager:{name:"Manager",approvalLimit:5e4,level:4,permissions:["all_basic","team_management","override_pricing"]},director:{name:"Director",approvalLimit:1/0,level:5,permissions:["full_access"]}},q={maxWorkHeight:15,maxWorkDepth:2,publicLiability:5e6};async function M(){let e=await (0,a.getServerSession)(i.L),[r,t,l,y,M,A]=await Promise.all([n._.procedure.count({where:{isLatestVersion:!0}}),n._.conflictReport.count(),n._.conflictReport.count({where:{severity:"CRITICAL",status:"DETECTED"}}),n._.category.count({where:{isActive:!0}}),n._.procedure.findMany({where:{isLatestVersion:!0},include:{category:!0,createdBy:{select:{firstName:!0,lastName:!0}}},orderBy:{updatedAt:"desc"},take:5}),n._.conflictReport.groupBy({by:["severity"],_count:{severity:!0}})]),S=[{title:"Total Procedures",value:r.toString(),description:"Active company procedures",icon:h.Z,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Active Conflicts",value:t.toString(),description:"Detected conflicts",icon:g.Z,color:"text-yellow-600",bgColor:"bg-yellow-100"},{title:"Critical Issues",value:l.toString(),description:"Require immediate attention",icon:f.Z,color:"text-red-600",bgColor:"bg-red-100"},{title:"Categories",value:y.toString(),description:"Knowledge categories",icon:j,color:"text-green-600",bgColor:"bg-green-100"}],P={LOW:"bg-gray-100 text-gray-800",MEDIUM:"bg-blue-100 text-blue-800",HIGH:"bg-orange-100 text-orange-800",CRITICAL:"bg-red-100 text-red-800"};return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold tracking-tight gradient-text",children:["Welcome back, ",e?.user?.name||e?.user?.email]}),s.jsx("p",{className:"text-muted-foreground",children:"Here's what's happening with your SFG Aluminium knowledge base today."})]}),s.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:S.map(e=>{let r=e.icon;return(0,s.jsxs)(u.Zb,{className:"hover:shadow-md transition-shadow",children:[(0,s.jsxs)(u.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(u.ll,{className:"text-sm font-medium",children:e.title}),s.jsx("div",{className:`${e.bgColor} ${e.color} p-2 rounded-md`,children:s.jsx(r,{className:"h-4 w-4"})})]}),(0,s.jsxs)(u.aY,{children:[s.jsx("div",{className:"text-2xl font-bold",children:e.value}),s.jsx("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},e.title)})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-2xl font-bold tracking-tight gradient-text",children:"Live Business Rules Validator"}),s.jsx("p",{className:"text-muted-foreground",children:"Test margin calculations, credit approvals, and insurance compliance in real-time using extracted SFG Aluminium rules"})]}),s.jsx(T,{})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,s.jsxs)(o,{glassLevel:"light",children:[s.jsx(c,{children:(0,s.jsxs)(d,{className:"text-base flex items-center gap-2",children:[s.jsx(v.Z,{className:"h-4 w-4"}),"Financial Targets"]})}),s.jsx(m,{children:(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-white/90",children:"Monthly Target"}),(0,s.jsxs)("span",{className:"text-white/60 font-semibold",children:["\xa3",Z.monthlyTurnover.toLocaleString()]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-white/90",children:"Daily Target"}),(0,s.jsxs)("span",{className:"text-white/60 font-semibold",children:["\xa3",Z.dailyTurnover.toLocaleString()]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-white/90",children:"Target Margin"}),(0,s.jsxs)("span",{className:"text-white/60 font-semibold",children:[Z.targetMarginMax,"%"]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-white/90",children:"Minimum Margin"}),(0,s.jsxs)("span",{className:"text-red-400 font-semibold",children:[Z.absoluteMinimumMargin,"%"]})]})]})})]}),(0,s.jsxs)(o,{glassLevel:"light",children:[s.jsx(c,{children:(0,s.jsxs)(d,{className:"text-base flex items-center gap-2",children:[s.jsx(w,{className:"h-4 w-4"}),"Staff Tiers"]})}),s.jsx(m,{children:s.jsx("div",{className:"space-y-2",children:Object.entries(L).map(([e,r])=>(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-white/90",children:r.name}),(0,s.jsxs)("span",{className:"text-white/60",children:["\xa3",r.approvalLimit===1/0?"Unlimited":r.approvalLimit.toLocaleString()]})]},e))})})]}),(0,s.jsxs)(o,{glassLevel:"light",children:[s.jsx(c,{children:(0,s.jsxs)(d,{className:"text-base flex items-center gap-2",children:[s.jsx(b.Z,{className:"h-4 w-4"}),"Insurance Limits"]})}),s.jsx(m,{children:(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-white/90",children:"Max Work Height"}),(0,s.jsxs)("span",{className:"text-white/60",children:[q.maxWorkHeight,"m"]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-white/90",children:"Max Work Depth"}),(0,s.jsxs)("span",{className:"text-white/60",children:[q.maxWorkDepth,"m"]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-white/90",children:"Public Liability"}),(0,s.jsxs)("span",{className:"text-white/60",children:["\xa3",(q.publicLiability/1e6).toFixed(0),"M"]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-white/90",children:"Groundwork"}),s.jsx(p.C,{variant:"destructive",className:"text-xs",children:"Prohibited"})]})]})})]})]}),(0,s.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,s.jsxs)(u.Zb,{children:[(0,s.jsxs)(u.Ol,{children:[(0,s.jsxs)(u.ll,{className:"flex items-center gap-2",children:[s.jsx(N.Z,{className:"h-5 w-5"}),"Recent Updates"]}),s.jsx(u.SZ,{children:"Latest procedure changes and additions"})]}),(0,s.jsxs)(u.aY,{className:"space-y-4",children:[M.length>0?M.map(e=>s.jsx("div",{className:"flex items-start space-x-3",children:(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[s.jsx(_.default,{href:`/procedures/${e.id}`,className:"text-sm font-medium hover:underline text-primary",children:e.title}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsx(p.C,{variant:"outline",className:"text-xs",children:e.category.name}),s.jsx(p.C,{className:`text-xs ${P[e.priority]}`,children:e.priority})]}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["By ",e.createdBy?.firstName," ",e.createdBy?.lastName]})]})},e.id)):s.jsx("p",{className:"text-sm text-muted-foreground",children:"No recent procedures found."}),s.jsx("div",{className:"pt-4",children:s.jsx(_.default,{href:"/procedures",children:s.jsx(x.z,{variant:"outline",size:"sm",children:"View All Procedures"})})})]})]}),(0,s.jsxs)(u.Zb,{children:[(0,s.jsxs)(u.Ol,{children:[(0,s.jsxs)(u.ll,{className:"flex items-center gap-2",children:[s.jsx(g.Z,{className:"h-5 w-5"}),"Conflicts Overview"]}),s.jsx(u.SZ,{children:"Current system conflicts by severity"})]}),(0,s.jsxs)(u.aY,{className:"space-y-4",children:[A.length>0?s.jsx("div",{className:"space-y-3",children:A.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center space-x-2",children:s.jsx(p.C,{className:"CRITICAL"===e.severity?"bg-red-100 text-red-800":"HIGH"===e.severity?"bg-orange-100 text-orange-800":"MEDIUM"===e.severity?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800",children:e.severity})}),s.jsx("span",{className:"text-sm font-medium",children:e._count.severity})]},e.severity))}):(0,s.jsxs)("div",{className:"text-center py-4",children:[s.jsx(k.Z,{className:"h-8 w-8 text-green-500 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"No conflicts detected"})]}),s.jsx("div",{className:"pt-4",children:s.jsx(_.default,{href:"/conflicts",children:s.jsx(x.z,{variant:"outline",size:"sm",children:"View All Conflicts"})})})]})]})]}),(0,s.jsxs)(u.Zb,{children:[(0,s.jsxs)(u.Ol,{children:[s.jsx(u.ll,{children:"Quick Actions"}),s.jsx(u.SZ,{children:"Common tasks and shortcuts"})]}),s.jsx(u.aY,{children:(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[s.jsx(_.default,{href:"/procedures/new",children:(0,s.jsxs)(x.z,{className:"w-full",variant:"outline",children:[s.jsx(h.Z,{className:"mr-2 h-4 w-4"}),"New Procedure"]})}),s.jsx(_.default,{href:"/categories",children:(0,s.jsxs)(x.z,{className:"w-full",variant:"outline",children:[s.jsx(j,{className:"mr-2 h-4 w-4"}),"Manage Categories"]})}),s.jsx(_.default,{href:"/import",children:(0,s.jsxs)(x.z,{className:"w-full",variant:"outline",children:[s.jsx(C.Z,{className:"mr-2 h-4 w-4"}),"Import Data"]})}),s.jsx(_.default,{href:"/chat",children:(0,s.jsxs)(x.z,{className:"w-full",variant:"outline",children:[s.jsx(w,{className:"mr-2 h-4 w-4"}),"AI Assistant"]})})]})})]})]})}},27244:(e,r,t)=>{"use strict";t.d(r,{C:()=>l});var s=t(83537);t(3995);var a=t(53290),i=t(64761);let n=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:r,...t}){return s.jsx("div",{className:(0,i.cn)(n({variant:r}),e),...t})}},66809:(e,r,t)=>{"use strict";t.d(r,{z:()=>u});var s=t(83537),a=t(3995),i=a.forwardRef((e,r)=>{let{children:t,...i}=e,l=a.Children.toArray(t),c=l.find(o);if(c){let e=c.props.children,t=l.map(r=>r!==c?r:a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null);return(0,s.jsx)(n,{...i,ref:r,children:a.isValidElement(e)?a.cloneElement(e,void 0,t):null})}return(0,s.jsx)(n,{...i,ref:r,children:t})});i.displayName="Slot";var n=a.forwardRef((e,r)=>{let{children:t,...s}=e;if(a.isValidElement(t)){let e=function(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning;return t?e.ref:(t=(r=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in r&&r.isReactWarning)?e.props.ref:e.props.ref||e.ref}(t);return a.cloneElement(t,{...function(e,r){let t={...r};for(let s in r){let a=e[s],i=r[s];/^on[A-Z]/.test(s)?a&&i?t[s]=(...e)=>{i(...e),a(...e)}:a&&(t[s]=a):"style"===s?t[s]={...a,...i}:"className"===s&&(t[s]=[a,i].filter(Boolean).join(" "))}return{...e,...t}}(s,t.props),ref:r?function(...e){return r=>e.forEach(e=>{"function"==typeof e?e(r):null!=e&&(e.current=r)})}(r,e):e})}return a.Children.count(t)>1?a.Children.only(null):null});n.displayName="SlotClone";var l=({children:e})=>(0,s.jsx)(s.Fragment,{children:e});function o(e){return a.isValidElement(e)&&e.type===l}var c=t(53290),d=t(64761);let m=(0,c.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=a.forwardRef(({className:e,variant:r,size:t,asChild:a=!1,...n},l)=>{let o=a?i:"button";return s.jsx(o,{className:(0,d.cn)(m({variant:r,size:t,className:e})),ref:l,...n})});u.displayName="Button"},31376:(e,r,t)=>{"use strict";t.d(r,{Ol:()=>l,SZ:()=>c,Zb:()=>n,aY:()=>d,ll:()=>o});var s=t(83537),a=t(3995),i=t(64761);let n=a.forwardRef(({className:e,...r},t)=>s.jsx("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...r}));n.displayName="Card";let l=a.forwardRef(({className:e,...r},t)=>s.jsx("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...r}));l.displayName="CardHeader";let o=a.forwardRef(({className:e,...r},t)=>s.jsx("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));o.displayName="CardTitle";let c=a.forwardRef(({className:e,...r},t)=>s.jsx("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",e),...r}));c.displayName="CardDescription";let d=a.forwardRef(({className:e,...r},t)=>s.jsx("div",{ref:t,className:(0,i.cn)("p-6 pt-0",e),...r}));d.displayName="CardContent",a.forwardRef(({className:e,...r},t)=>s.jsx("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",e),...r})).displayName="CardFooter"},64761:(e,r,t)=>{"use strict";t.d(r,{cn:()=>i});var s=t(61862),a=t(82703);function i(...e){return(0,a.m6)((0,s.W)(e))}},89004:(e,r,t)=>{"use strict";t.d(r,{Z:()=>o});var s=t(3995);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=(...e)=>e.filter((e,r,t)=>!!e&&t.indexOf(e)===r).join(" ");var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,s.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:t=2,absoluteStrokeWidth:a,className:l="",children:o,iconNode:c,...d},m)=>(0,s.createElement)("svg",{ref:m,...n,width:r,height:r,stroke:e,strokeWidth:a?24*Number(t)/Number(r):t,className:i("lucide",l),...d},[...c.map(([e,r])=>(0,s.createElement)(e,r)),...Array.isArray(o)?o:[o]])),o=(e,r)=>{let t=(0,s.forwardRef)(({className:t,...n},o)=>(0,s.createElement)(l,{ref:o,iconNode:r,className:i(`lucide-${a(e)}`,t),...n}));return t.displayName=`${e}`,t}},61112:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});let s=(0,t(89004).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},79118:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});let s=(0,t(89004).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},61996:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});let s=(0,t(89004).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},34241:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});let s=(0,t(89004).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},25201:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});let s=(0,t(89004).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},7649:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});let s=(0,t(89004).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},86132:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});let s=(0,t(89004).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},47615:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});let s=(0,t(89004).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},53290:(e,r,t)=>{"use strict";t.d(r,{j:()=>i});let s=e=>"boolean"==typeof e?"".concat(e):0===e?"0":e,a=function(){for(var e,r,t=0,s="";t<arguments.length;)(e=arguments[t++])&&(r=function e(r){var t,s,a="";if("string"==typeof r||"number"==typeof r)a+=r;else if("object"==typeof r){if(Array.isArray(r))for(t=0;t<r.length;t++)r[t]&&(s=e(r[t]))&&(a&&(a+=" "),a+=s);else for(t in r)r[t]&&(a&&(a+=" "),a+=t)}return a}(e))&&(s&&(s+=" "),s+=r);return s},i=(e,r)=>t=>{var i;if((null==r?void 0:r.variants)==null)return a(e,null==t?void 0:t.class,null==t?void 0:t.className);let{variants:n,defaultVariants:l}=r,o=Object.keys(n).map(e=>{let r=null==t?void 0:t[e],a=null==l?void 0:l[e];if(null===r)return null;let i=s(r)||s(a);return n[e][i]}),c=t&&Object.entries(t).reduce((e,r)=>{let[t,s]=r;return void 0===s||(e[t]=s),e},{});return a(e,o,null==r?void 0:null===(i=r.compoundVariants)||void 0===i?void 0:i.reduce((e,r)=>{let{class:t,className:s,...a}=r;return Object.entries(a).every(e=>{let[r,t]=e;return Array.isArray(t)?t.includes({...l,...c}[r]):({...l,...c})[r]===t})?[...e,t,s]:e},[]),null==t?void 0:t.class,null==t?void 0:t.className)}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[4372,7329,4958,302,1263,5003,7343,255,5653,7731,4913],()=>t(60627));module.exports=s})();