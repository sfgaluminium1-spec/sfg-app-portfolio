(()=>{var e={};e.id=4204,e.ids=[4204],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9123:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>h,pages:()=>c,routeModule:()=>m,tree:()=>d}),r(79780),r(70443),r(71363);var t=r(36576),a=r(72007),n=r(21818),i=r.n(n),o=r(88897),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(s,l);let d=["",{children:["sharepoint-docs",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,79780)),"/home/ubuntu/company_wiki/nextjs_space/app/sharepoint-docs/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,70443)),"/home/ubuntu/company_wiki/nextjs_space/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,71363,23)),"next/dist/client/components/not-found-error"]}],c=["/home/ubuntu/company_wiki/nextjs_space/app/sharepoint-docs/page.tsx"],h="/sharepoint-docs/page",u={require:r,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/sharepoint-docs/page",pathname:"/sharepoint-docs",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1651:(e,s,r)=>{Promise.resolve().then(r.bind(r,58517))},68744:(e,s,r)=>{Promise.resolve().then(r.bind(r,75282))},87133:(e,s,r)=>{Promise.resolve().then(r.t.bind(r,84114,23)),Promise.resolve().then(r.t.bind(r,28866,23)),Promise.resolve().then(r.t.bind(r,31324,23)),Promise.resolve().then(r.t.bind(r,83567,23)),Promise.resolve().then(r.t.bind(r,55996,23)),Promise.resolve().then(r.t.bind(r,10050,23))},58517:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>b});var t=r(62901),a=r(24383),n=r(23803),i=r(250),o=r(27878),l=r(84227),d=r(71945);let c=(0,d.Z)("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),h=(0,d.Z)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);var u=r(21391),m=r(68734),p=r(83898),x=r(32317);let f=(0,d.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var g=r(91046),j=r(917),v=r(39350),y=r(18665);function b(){let[e,s]=(0,a.useState)(""),[r,d]=(0,a.useState)([]),[b,w]=(0,a.useState)(null),[N,k]=(0,a.useState)([]),[S,P]=(0,a.useState)(null),[Z,_]=(0,a.useState)([]),[A,M]=(0,a.useState)([]),[C,F]=(0,a.useState)([]),[E,q]=(0,a.useState)(""),[z,I]=(0,a.useState)(!1),$=async()=>{I(!0);try{let e=await fetch("/api/sharepoint/sites"),s=await e.json();if(!e.ok)throw Error(s.error);d(s)}catch(e){v.Am.error(e.message||"Failed to load SharePoint sites"),console.error("Load sites error:",e)}finally{I(!1)}},D=async e=>{I(!0),w(e);try{let s=await fetch(`/api/sharepoint/drives?siteId=${e.id}`),r=await s.json();if(!s.ok)throw Error(r.error);k(r),r.length>0&&O(e,r[0],"")}catch(e){v.Am.error(e.message||"Failed to load drives"),console.error("Load drives error:",e)}finally{I(!1)}},O=async(e,s,r)=>{I(!0),P(s),q(r);try{let t=`/api/sharepoint/files?siteId=${e.id}&driveId=${s.id}${r?`&path=${encodeURIComponent(r)}`:""}`,a=await fetch(t),n=await a.json();if(!a.ok)throw Error(n.error);_(n)}catch(e){v.Am.error(e.message||"Failed to load files"),console.error("Load files error:",e)}finally{I(!1)}},R=async()=>{if(!e.trim()){v.Am.error("Please enter a search query");return}I(!0);try{let s=`/api/sharepoint/search?q=${encodeURIComponent(e)}${b?`&siteId=${b.id}`:""}`,r=await fetch(s),t=await r.json();if(!r.ok)throw Error(t.error);F(t),0===t.length&&v.Am.error("No files found")}catch(e){v.Am.error(e.message||"Search failed"),console.error("Search error:",e)}finally{I(!1)}},H=async e=>{if(!b||!S){v.Am.error("Please select a site and drive first");return}try{let s=await fetch(`/api/sharepoint/download?siteId=${b.id}&driveId=${S.id}&itemId=${e.id}`),r=await s.json();if(!s.ok)throw Error(r.error);window.open(r.downloadUrl,"_blank"),v.Am.success("Opening file...")}catch(e){v.Am.error(e.message||"Failed to download file"),console.error("Download error:",e)}},B=e=>{if(!e)return"N/A";let s=e/1024,r=s/1024;return r>=1?`${r.toFixed(2)} MB`:`${s.toFixed(2)} KB`},L=e=>e.folder?t.jsx(c,{className:"w-5 h-5 text-blue-500"}):t.jsx(h,{className:"w-5 h-5 text-gray-500"}),U=({files:e})=>t.jsx("div",{className:"space-y-2",children:e.map(e=>{var s,r,a;return t.jsx(n.Zb,{className:`cursor-pointer hover:bg-muted/50 transition-colors ${e.folder?"border-blue-200":""}`,onClick:()=>{e.folder&&b&&S&&O(b,S,E?`${E}/${e.name}`:e.name)},children:t.jsx(n.aY,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[L(e),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"font-medium truncate",children:e.name}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mt-1",children:[t.jsx("span",{children:B(e.size)}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[t.jsx(u.Z,{className:"w-3 h-3"}),(s=new Date(e.lastModifiedDateTime),r={addSuffix:!0},(0,y.B)(s,(a=Date.now(),s instanceof Date?new s.constructor(a):new Date(a)),r))]}),e.createdBy?.user?.displayName&&(0,t.jsxs)("span",{children:["by ",e.createdBy.user.displayName]})]})]})]}),t.jsx("div",{className:"flex items-center gap-2",children:!e.folder&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.z,{size:"sm",variant:"outline",onClick:s=>{s.stopPropagation(),H(e)},children:[t.jsx(m.Z,{className:"w-4 h-4 mr-1"}),"Download"]}),t.jsx(o.z,{size:"sm",variant:"ghost",onClick:s=>{s.stopPropagation(),window.open(e.webUrl,"_blank")},children:t.jsx(p.Z,{className:"w-4 h-4"})})]})})]})})},e.id)})});return(0,t.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[t.jsx(x.Z,{className:"w-8 h-8"}),"SharePoint Documents"]}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Browse and access your SharePoint files and documents"})]}),(0,t.jsxs)(o.z,{onClick:$,disabled:z,children:[t.jsx(f,{className:`w-4 h-4 mr-2 ${z?"animate-spin":""}`}),"Refresh"]})]}),(0,t.jsxs)(n.Zb,{children:[(0,t.jsxs)(n.Ol,{children:[t.jsx(n.ll,{children:"Search Documents"}),t.jsx(n.SZ,{children:"Search across all SharePoint sites and documents"})]}),t.jsx(n.aY,{children:(0,t.jsxs)("div",{className:"flex gap-2",children:[t.jsx(i.I,{placeholder:"Enter search term...",value:e,onChange:e=>s(e.target.value),onKeyDown:e=>"Enter"===e.key&&R()}),(0,t.jsxs)(o.z,{onClick:R,disabled:z,children:[t.jsx(g.Z,{className:"w-4 h-4 mr-2"}),"Search"]})]})})]}),(0,t.jsxs)(l.mQ,{defaultValue:"browse",className:"w-full",children:[(0,t.jsxs)(l.dr,{className:"grid w-full grid-cols-3",children:[t.jsx(l.SP,{value:"browse",children:"Browse"}),t.jsx(l.SP,{value:"recent",children:"Recent Files"}),t.jsx(l.SP,{value:"search",children:"Search Results"})]}),(0,t.jsxs)(l.nU,{value:"browse",className:"space-y-4",children:[!b&&(0,t.jsxs)(n.Zb,{children:[t.jsx(n.Ol,{children:(0,t.jsxs)(n.ll,{className:"flex items-center gap-2",children:[t.jsx(j.Z,{className:"w-5 h-5"}),"SharePoint Sites (",r.length,")"]})}),t.jsx(n.aY,{children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map(e=>t.jsx(n.Zb,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>D(e),children:(0,t.jsxs)(n.aY,{className:"p-4",children:[t.jsx("h4",{className:"font-semibold",children:e.displayName}),e.description&&t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.description})]})},e.id))})})]}),b&&(0,t.jsxs)("div",{className:"space-y-4",children:[t.jsx(n.Zb,{children:t.jsx(n.aY,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx(o.z,{variant:"ghost",size:"sm",onClick:()=>{w(null),P(null),_([]),q("")},children:"Sites"}),t.jsx("span",{children:"/"}),t.jsx("span",{className:"font-semibold",children:b.displayName}),S&&(0,t.jsxs)(t.Fragment,{children:[t.jsx("span",{children:"/"}),t.jsx("span",{children:S.name})]}),E&&(0,t.jsxs)(t.Fragment,{children:[t.jsx("span",{children:"/"}),t.jsx("span",{children:E})]}),E&&t.jsx(o.z,{variant:"ghost",size:"sm",onClick:()=>{let e=E.split("/");e.pop();let s=e.join("/");b&&S&&O(b,S,s)},children:"â† Back"})]})})}),(0,t.jsxs)(n.Zb,{children:[t.jsx(n.Ol,{children:t.jsx(n.ll,{children:"Files and Folders"})}),t.jsx(n.aY,{children:0===Z.length?t.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No files found"}):t.jsx(U,{files:Z})})]})]})]}),t.jsx(l.nU,{value:"recent",className:"space-y-4",children:(0,t.jsxs)(n.Zb,{children:[t.jsx(n.Ol,{children:(0,t.jsxs)(n.ll,{className:"flex items-center gap-2",children:[t.jsx(u.Z,{className:"w-5 h-5"}),"Recent Files"]})}),t.jsx(n.aY,{children:0===A.length?t.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No recent files"}):t.jsx(U,{files:A})})]})}),t.jsx(l.nU,{value:"search",className:"space-y-4",children:(0,t.jsxs)(n.Zb,{children:[t.jsx(n.Ol,{children:(0,t.jsxs)(n.ll,{className:"flex items-center gap-2",children:[t.jsx(g.Z,{className:"w-5 h-5"}),"Search Results (",C.length,")"]})}),t.jsx(n.aY,{children:0===C.length?t.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No search results. Use the search bar above to find files."}):t.jsx(U,{files:C})})]})})]})]})}},75282:(e,s,r)=>{"use strict";r.d(s,{Providers:()=>h});var t,a=r(62901),n=r(84700);r(24383);var i=r(69878);function o({children:e,...s}){return a.jsx(i.f,{...s,children:e})}var l=r(43921);let d=({...e})=>{let{theme:s="system"}=(0,i.F)();return a.jsx(l.x7,{theme:s,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};function c({children:e,className:s=""}){let{data:r}=(0,n.useSession)()||{},i=(()=>{if(!r?.user)return"sales";let e=r.user.tierLevel;return e===t.CEO||"SUPER_ADMIN"===r.user.role?"ceo":e===t.FINANCE||"ADMIN"===r.user.role?"finance":"sales"})();return a.jsx("div",{"data-tier":i,className:s,children:e})}function h({children:e}){return a.jsx(n.SessionProvider,{children:a.jsx(o,{attribute:"class",defaultTheme:"dark",enableSystem:!1,disableTransitionOnChange:!0,children:(0,a.jsxs)(c,{children:[e,a.jsx(d,{position:"top-right"})]})})})}!function(e){e.CEO="CEO",e.FINANCE="FINANCE",e.SALES="SALES"}(t||(t={}))},27878:(e,s,r)=>{"use strict";r.d(s,{z:()=>d});var t=r(62901),a=r(24383),n=r(42049),i=r(47279),o=r(68637);let l=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef(({className:e,variant:s,size:r,asChild:a=!1,...i},d)=>{let c=a?n.g7:"button";return t.jsx(c,{className:(0,o.cn)(l({variant:s,size:r,className:e})),ref:d,...i})});d.displayName="Button"},250:(e,s,r)=>{"use strict";r.d(s,{I:()=>i});var t=r(62901),a=r(24383),n=r(68637);let i=a.forwardRef(({className:e,type:s,...r},a)=>t.jsx("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...r}));i.displayName="Input"},68637:(e,s,r)=>{"use strict";r.d(s,{cn:()=>n});var t=r(84330),a=r(77189);function n(...e){return(0,a.m6)((0,t.W)(e))}},21391:(e,s,r)=>{"use strict";r.d(s,{Z:()=>t});let t=(0,r(71945).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},68734:(e,s,r)=>{"use strict";r.d(s,{Z:()=>t});let t=(0,r(71945).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},83898:(e,s,r)=>{"use strict";r.d(s,{Z:()=>t});let t=(0,r(71945).Z)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},32317:(e,s,r)=>{"use strict";r.d(s,{Z:()=>t});let t=(0,r(71945).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},917:(e,s,r)=>{"use strict";r.d(s,{Z:()=>t});let t=(0,r(71945).Z)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]])},91046:(e,s,r)=>{"use strict";r.d(s,{Z:()=>t});let t=(0,r(71945).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},70443:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>l,metadata:()=>o});var t=r(83537),a=r(57416),n=r.n(a);r(26148);let i=(0,r(88895).createProxy)(String.raw`/home/ubuntu/company_wiki/nextjs_space/components/providers.tsx#Providers`),o={title:"SFG Aluminium Wiki - Knowledge Management System",description:"Comprehensive company knowledge management, operational procedures, and RAG-enabled wiki system for SFG Aluminium",icons:{icon:"/favicon.svg",shortcut:"/favicon.svg"}};function l({children:e}){return t.jsx("html",{lang:"en",children:t.jsx("body",{className:n().className,children:t.jsx(i,{children:e})})})}},79780:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>t});let t=(0,r(88895).createProxy)(String.raw`/home/ubuntu/company_wiki/nextjs_space/app/sharepoint-docs/page.tsx#default`)},26148:()=>{}};var s=require("../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[4372,302,1263,1813,8665,7486],()=>r(9123));module.exports=t})();