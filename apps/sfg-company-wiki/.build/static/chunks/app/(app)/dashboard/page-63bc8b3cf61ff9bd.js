(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[40],{9820:function(e,r,t){Promise.resolve().then(t.bind(t,3504)),Promise.resolve().then(t.bind(t,6541)),Promise.resolve().then(t.t.bind(t,5558,23))},3504:function(e,r,t){"use strict";t.d(r,{RulesValidator:function(){return g}});var a=t(5444),s=t(9300),i=t(6541),n=t(2422),o=t(4678),l=t(4635),c=t(489),d=t(2690),u=t(362),m=t(7694);let p={supplyAndInstall:{target:45,minimum:28,type:"Supply & Install"},supplyOnly:{target:30,minimum:28,type:"Supply Only"},maintenance:{base:10,markup:20,minimum:28,type:"Maintenance & Repair"},corporate:{target:55,minimum:28,type:"Corporate Contract"}},h={junior:{name:"Junior Estimator",approvalLimit:1e3,level:1,permissions:["view_enquiries","create_enquiries"]},standard:{name:"Estimator",approvalLimit:5e3,level:2,permissions:["view_enquiries","create_enquiries","edit_quotes","view_customers"]},senior:{name:"Senior Estimator",approvalLimit:15e3,level:3,permissions:["view_enquiries","create_enquiries","edit_quotes","view_customers","approve_quotes","credit_checks"]},manager:{name:"Manager",approvalLimit:5e4,level:4,permissions:["all_basic","team_management","override_pricing"]},director:{name:"Director",approvalLimit:1/0,level:5,permissions:["full_access"]}},x={maxWorkHeight:15,maxWorkDepth:2,minSubcontractorPL:5e6},f=["groundwork","excavation","demolition","pile_driving","railway_work","airside_work","offshore_work","power_station_work"];function g(){let[e,r]=(0,s.useState)({}),[t,g]=(0,s.useState)({jobType:"supplyAndInstall",cost:1e4,price:18e3}),[w,b]=(0,s.useState)({amount:5e3,userTier:"standard"}),[v,j]=(0,s.useState)({workHeight:10,workDepth:1,includesGroundwork:!1,workType:[]});return(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[(0,a.jsxs)(i.TransparentCard,{children:[(0,a.jsx)(i.TransparentCardHeader,{children:(0,a.jsx)(i.TransparentCardTitle,{className:"text-lg",children:"Margin Validator"})}),(0,a.jsxs)(i.TransparentCardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l._,{htmlFor:"jobType",className:"text-white",children:"Job Type"}),(0,a.jsxs)(c.Ph,{value:t.jobType,onValueChange:e=>g(r=>({...r,jobType:e})),children:[(0,a.jsx)(c.i4,{id:"jobType",className:"bg-white/10 text-white border-white/20",children:(0,a.jsx)(c.ki,{})}),(0,a.jsx)(c.Bw,{children:Object.entries(p).map(([e,r])=>(0,a.jsx)(c.Ql,{value:e,children:r.type},e))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l._,{htmlFor:"cost",className:"text-white",children:"Cost (\xa3)"}),(0,a.jsx)(o.I,{id:"cost",type:"number",value:t.cost,onChange:e=>g(r=>({...r,cost:parseFloat(e.target.value)||0})),className:"bg-white/10 text-white border-white/20"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l._,{htmlFor:"price",className:"text-white",children:"Price (\xa3)"}),(0,a.jsx)(o.I,{id:"price",type:"number",value:t.price,onChange:e=>g(r=>({...r,price:parseFloat(e.target.value)||0})),className:"bg-white/10 text-white border-white/20"})]}),(0,a.jsx)(n.z,{onClick:()=>{let e=function(e,r,t){let a=p[e],s=(t-r)/t*100,i="target"in a?a.target:a.base+a.markup,n=a.minimum,o="ok",l=`Margin ${s.toFixed(1)}% is within target range`;return s<n?(o="critical",l=`ðŸš¨ BLOCKED: Margin ${s.toFixed(1)}% is below absolute minimum ${n}%. Director approval required.`):s<i&&(o="warning",l=`âš ï¸ WARNING: Margin ${s.toFixed(1)}% is below target ${i}%. Consider repricing.`),{isValid:s>=n,margin:s,targetMargin:i,minimumMargin:n,variance:s-i,severity:o,message:l}}(t.jobType,t.cost,t.price);r(r=>({...r,margin:e}))},className:"w-full",children:"Validate Margin"}),e.margin&&(0,a.jsx)("div",{className:`p-4 rounded-lg ${"ok"===e.margin.severity?"bg-green-500/20 border border-green-500/50":"warning"===e.margin.severity?"bg-yellow-500/20 border border-yellow-500/50":"bg-red-500/20 border border-red-500/50"}`,children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:["ok"===e.margin.severity&&(0,a.jsx)(d.Z,{className:"h-5 w-5 text-green-400 mt-0.5"}),"warning"===e.margin.severity&&(0,a.jsx)(u.Z,{className:"h-5 w-5 text-yellow-400 mt-0.5"}),"critical"===e.margin.severity&&(0,a.jsx)(m.Z,{className:"h-5 w-5 text-red-400 mt-0.5"}),(0,a.jsxs)("div",{className:"flex-1 text-sm text-white",children:[(0,a.jsxs)("p",{className:"font-semibold",children:["Margin: ",e.margin.margin.toFixed(1),"%"]}),(0,a.jsx)("p",{className:"text-white/80 mt-1",children:e.margin.message})]})]})})]})]}),(0,a.jsxs)(i.TransparentCard,{children:[(0,a.jsx)(i.TransparentCardHeader,{children:(0,a.jsx)(i.TransparentCardTitle,{className:"text-lg",children:"Credit Approval"})}),(0,a.jsxs)(i.TransparentCardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l._,{htmlFor:"amount",className:"text-white",children:"Amount (\xa3)"}),(0,a.jsx)(o.I,{id:"amount",type:"number",value:w.amount,onChange:e=>b(r=>({...r,amount:parseFloat(e.target.value)||0})),className:"bg-white/10 text-white border-white/20"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l._,{htmlFor:"userTier",className:"text-white",children:"Your Staff Tier"}),(0,a.jsxs)(c.Ph,{value:w.userTier,onValueChange:e=>b(r=>({...r,userTier:e})),children:[(0,a.jsx)(c.i4,{id:"userTier",className:"bg-white/10 text-white border-white/20",children:(0,a.jsx)(c.ki,{})}),(0,a.jsx)(c.Bw,{children:Object.entries(h).map(([e,r])=>(0,a.jsxs)(c.Ql,{value:e,children:[r.name," (\xa3",r.approvalLimit===1/0?"Unlimited":r.approvalLimit.toLocaleString(),")"]},e))})]})]}),(0,a.jsx)(n.z,{onClick:()=>{let e=function(e,r){let t=h[r],a=e<=t.approvalLimit,s="junior";for(let[r,t]of Object.entries(h))if(e<=t.approvalLimit){s=r;break}return{requiresApproval:!0,minimumStaffTier:s,canCurrentUserApprove:a,escalationRequired:!a,message:a?`âœ… You can approve this (\xa3${e.toLocaleString()})`:`âš ï¸ Escalation required to ${h[s].name} (\xa3${e.toLocaleString()} exceeds your \xa3${t.approvalLimit.toLocaleString()} limit)`}}(w.amount,w.userTier);r(r=>({...r,credit:e}))},className:"w-full",children:"Check Approval"}),e.credit&&(0,a.jsx)("div",{className:`p-4 rounded-lg ${e.credit.canCurrentUserApprove?"bg-green-500/20 border border-green-500/50":"bg-yellow-500/20 border border-yellow-500/50"}`,children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[e.credit.canCurrentUserApprove?(0,a.jsx)(d.Z,{className:"h-5 w-5 text-green-400 mt-0.5"}):(0,a.jsx)(u.Z,{className:"h-5 w-5 text-yellow-400 mt-0.5"}),(0,a.jsx)("p",{className:"flex-1 text-sm text-white",children:e.credit.message})]})})]})]}),(0,a.jsxs)(i.TransparentCard,{children:[(0,a.jsx)(i.TransparentCardHeader,{children:(0,a.jsx)(i.TransparentCardTitle,{className:"text-lg",children:"Insurance Check"})}),(0,a.jsxs)(i.TransparentCardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l._,{htmlFor:"workHeight",className:"text-white",children:"Work Height (m)"}),(0,a.jsx)(o.I,{id:"workHeight",type:"number",value:v.workHeight,onChange:e=>j(r=>({...r,workHeight:parseFloat(e.target.value)||0})),className:"bg-white/10 text-white border-white/20"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l._,{htmlFor:"workDepth",className:"text-white",children:"Work Depth (m)"}),(0,a.jsx)(o.I,{id:"workDepth",type:"number",value:v.workDepth,onChange:e=>j(r=>({...r,workDepth:parseFloat(e.target.value)||0})),className:"bg-white/10 text-white border-white/20"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{id:"groundwork",type:"checkbox",checked:v.includesGroundwork,onChange:e=>j(r=>({...r,includesGroundwork:e.target.checked})),className:"h-4 w-4"}),(0,a.jsx)(l._,{htmlFor:"groundwork",className:"text-white cursor-pointer",children:"Includes Groundwork"})]}),(0,a.jsx)(n.z,{onClick:()=>{let e=function(e){let r=[],t=[];e.workHeight&&e.workHeight>x.maxWorkHeight&&r.push(`ðŸš¨ CRITICAL: Work height ${e.workHeight}m exceeds insurance limit of ${x.maxWorkHeight}m (Endorsement 25)`),e.workDepth&&e.workDepth>x.maxWorkDepth&&r.push(`ðŸš¨ CRITICAL: Work depth ${e.workDepth}m exceeds insurance limit of ${x.maxWorkDepth}m (Endorsement 12)`),e.includesGroundwork&&r.push(`ðŸš¨ CRITICAL: Groundwork is explicitly excluded from insurance (Endorsement 60)`);let a=e.workType.filter(e=>f.includes(e));return a.length>0&&r.push(`ðŸš¨ CRITICAL: Prohibited work types detected: ${a.join(", ")} (Hazardous Works Exclusion 593)`),e.subcontractors&&e.subcontractors.forEach(e=>{e.plCover<x.minSubcontractorPL&&r.push(`ðŸš¨ CRITICAL: Subcontractor "${e.name}" has insufficient PL cover (\xa3${e.plCover.toLocaleString()} < required \xa3${x.minSubcontractorPL.toLocaleString()})`)}),e.workHeight&&e.workHeight>.8*x.maxWorkHeight&&t.push(`âš ï¸ Work height ${e.workHeight}m is approaching insurance limit`),{isPermitted:0===r.length,violations:r,warnings:t,requiresSpecialApproval:r.length>0}}(v);r(r=>({...r,insurance:e}))},className:"w-full",children:"Check Insurance"}),e.insurance&&(0,a.jsx)("div",{className:`p-4 rounded-lg ${e.insurance.isPermitted?"bg-green-500/20 border border-green-500/50":"bg-red-500/20 border border-red-500/50"}`,children:(0,a.jsxs)("div",{className:"space-y-2",children:[e.insurance.isPermitted?(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(d.Z,{className:"h-5 w-5 text-green-400 mt-0.5"}),(0,a.jsx)("p",{className:"flex-1 text-sm text-white font-semibold",children:"âœ… Work is covered by insurance"})]}):(0,a.jsx)(a.Fragment,{children:e.insurance.violations.map((e,r)=>(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(m.Z,{className:"h-5 w-5 text-red-400 mt-0.5 flex-shrink-0"}),(0,a.jsx)("p",{className:"flex-1 text-xs text-white",children:e})]},r))}),e.insurance.warnings.length>0&&(0,a.jsx)("div",{className:"mt-2 pt-2 border-t border-white/20",children:e.insurance.warnings.map((e,r)=>(0,a.jsxs)("div",{className:"flex items-start gap-2 mt-1",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 text-yellow-400 mt-0.5 flex-shrink-0"}),(0,a.jsx)("p",{className:"flex-1 text-xs text-white/80",children:e})]},r))})]})})]})]})]})}},2422:function(e,r,t){"use strict";t.d(r,{z:function(){return c}});var a=t(5444),s=t(9300),i=t(223),n=t(2371),o=t(5522);let l=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef(({className:e,variant:r,size:t,asChild:s=!1,...n},c)=>{let d=s?i.g7:"button";return(0,a.jsx)(d,{className:(0,o.cn)(l({variant:r,size:t,className:e})),ref:c,...n})});c.displayName="Button"},4678:function(e,r,t){"use strict";t.d(r,{I:function(){return n}});var a=t(5444),s=t(9300),i=t(5522);let n=s.forwardRef(({className:e,type:r,...t},s)=>(0,a.jsx)("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...t}));n.displayName="Input"},4635:function(e,r,t){"use strict";t.d(r,{_:function(){return c}});var a=t(5444),s=t(9300),i=t(4100),n=t(2371),o=t(5522);let l=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)(i.f,{ref:t,className:(0,o.cn)(l(),e),...r}));c.displayName=i.f.displayName},489:function(e,r,t){"use strict";t.d(r,{Bw:function(){return x},Ph:function(){return d},Ql:function(){return f},i4:function(){return m},ki:function(){return u}});var a=t(5444),s=t(9300),i=t(7659),n=t(3751),o=t(6997),l=t(7248),c=t(5522);let d=i.fC;i.ZA;let u=i.B4,m=s.forwardRef(({className:e,children:r,...t},s)=>(0,a.jsxs)(i.xz,{ref:s,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...t,children:[r,(0,a.jsx)(i.JO,{asChild:!0,children:(0,a.jsx)(n.Z,{className:"h-4 w-4 opacity-50"})})]}));m.displayName=i.xz.displayName;let p=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)(i.u_,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",e),...r,children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})}));p.displayName=i.u_.displayName;let h=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)(i.$G,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",e),...r,children:(0,a.jsx)(n.Z,{className:"h-4 w-4"})}));h.displayName=i.$G.displayName;let x=s.forwardRef(({className:e,children:r,position:t="popper",...s},n)=>(0,a.jsx)(i.h_,{children:(0,a.jsxs)(i.VY,{ref:n,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===t&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:t,...s,children:[(0,a.jsx)(p,{}),(0,a.jsx)(i.l_,{className:(0,c.cn)("p-1","popper"===t&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(h,{})]})}));x.displayName=i.VY.displayName,s.forwardRef(({className:e,...r},t)=>(0,a.jsx)(i.__,{ref:t,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...r})).displayName=i.__.displayName;let f=s.forwardRef(({className:e,children:r,...t},s)=>(0,a.jsxs)(i.ck,{ref:s,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(i.wU,{children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(i.eT,{children:r})]}));f.displayName=i.ck.displayName,s.forwardRef(({className:e,...r},t)=>(0,a.jsx)(i.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",e),...r})).displayName=i.Z0.displayName},6541:function(e,r,t){"use strict";t.d(r,{TransparentCard:function(){return n},TransparentCardContent:function(){return c},TransparentCardHeader:function(){return o},TransparentCardTitle:function(){return l}});var a=t(5444);t(9300);var s=t(5522);let i={none:"",light:"bg-white/5 backdrop-blur-sm",medium:"bg-white/10 backdrop-blur-md",heavy:"bg-white/20 backdrop-blur-lg"};function n({children:e,className:r,glassLevel:t="medium",...n}){return(0,a.jsx)("div",{className:(0,s.cn)("rounded-lg border border-white/10 shadow-xl",i[t],r),...n,children:e})}function o({children:e,className:r,...t}){return(0,a.jsx)("div",{className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...t,children:e})}function l({children:e,className:r,...t}){return(0,a.jsx)("h3",{className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight text-white",r),...t,children:e})}function c({children:e,className:r,...t}){return(0,a.jsx)("div",{className:(0,s.cn)("p-6 pt-0",r),...t,children:e})}},5522:function(e,r,t){"use strict";t.d(r,{cn:function(){return i}});var a=t(2191),s=t(3607);function i(...e){return(0,s.m6)((0,a.W)(e))}},2690:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(2154).Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},7694:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(2154).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},362:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(2154).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},4100:function(e,r,t){"use strict";t.d(r,{f:function(){return o}});var a=t(9300),s=t(7234),i=t(5444),n=a.forwardRef((e,r)=>(0,i.jsx)(s.WV.label,{...e,ref:r,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));n.displayName="Label";var o=n}},function(e){e.O(0,[6730,5558,9727,1666,2386,7156,1744],function(){return e(e.s=9820)}),_N_E=e.O()}]);