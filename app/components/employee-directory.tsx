 'use client'; import React, { useState, useEffect } from 'react'; import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'; import { Badge } from '@/components/ui/badge'; import { Button } from '@/components/ui/button'; import { Input } from '@/components/ui/input'; import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'; import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'; import { Avatar, AvatarFallback } from '@/components/ui/avatar'; import { Users, Shield, Phone, Mail, MapPin, Calendar, Award, Search, Filter, UserCheck, Building, Crown, Star, Settings } from 'lucide-react'; interface SecurityTier { id: string; tierId: number; tierName: string; description: string; hasFullSystemAccess: boolean; hasFinancialAccess: boolean; hasDepartmentAccess: boolean; hasTeamManagementAccess: boolean; canApproveQuotes: boolean; canApproveJobs: boolean; canManageSchedule: boolean; canViewReports: boolean; canManageUsers: boolean; maxApprovalValue: number | null; } interface Employee { id: string; employeeNumber: string | null; firstName: string; lastName: string; fullName: string; email: string; phone: string | null; role: string; department: string | null; securityTier: SecurityTier; scheduleColorCode: string | null; scheduleNickname: string | null; accessDetails: string | null; skills: string[]; certifications: string[]; isTeamLeader: boolean; canManageTeam: boolean; isActive: boolean; startDate: string | null; manager: { id: string; fullName: string; role: string; } | null; directReports: { id: string; fullName: string; role: string; }[]; scheduleColor: { colorName: string; colorCode: string; staffNickname: string; } | null; } interface ScheduleColor { id: string; colorName: string; colorCode: string; staffNickname: string; priorityLevel: number; assignedEmployee: { id: string; fullName: string; role: string; email: string; } | null; } const getSecurityTierColor = (tierId: number) => { switch (tierId) { case 1: return 'bg-red-100 text-red-800 border-red-200'; case 2: return 'bg-orange-100 text-orange-800 border-orange-200'; case 3: return 'bg-yellow-100 text-yellow-800 border-yellow-200'; case 4: return 'bg-blue-100 text-blue-800 border-blue-200'; case 5: return 'bg-green-100 text-green-800 border-green-200'; case 6: return 'bg-gray-100 text-gray-800 border-gray-200'; default: return 'bg-gray-100 text-gray-800 border-gray-200'; } }; const getSecurityTierIcon = (tierId: number) => { switch (tierId) { case 1: return Crown; case 2: return Award; case 3: return Star; case 4: return UserCheck; case 5: return Users; case 6: return Settings; default: return Users; } }; export default function EmployeeDirectory() { const [employees, setEmployees] = useState<Employee[]>([]); const [securityTiers, setSecurityTiers] = useState<SecurityTier[]>([]); const [scheduleColors, setScheduleColors] = useState<ScheduleColor[]>([]); const [loading, setLoading] = useState(true); const [searchTerm, setSearchTerm] = useState(''); const [departmentFilter, setDepartmentFilter] = useState('all'); const [tierFilter, setTierFilter] = useState('all'); const [activeTab, setActiveTab] = useState('directory'); useEffect(() => { fetchData(); }, []); const fetchData = async () => { try { const [employeesRes, tiersRes, colorsRes] = await Promise.all([ fetch('/api/employees'), fetch('/api/security-tiers'), fetch('/api/schedule-colors') ]); const employeesData = await employeesRes.json(); const tiersData = await tiersRes.json(); const colorsData = await colorsRes.json(); setEmployees(employeesData); setSecurityTiers(tiersData); setScheduleColors(colorsData); } catch (error) { console.error('Error fetching data:', error); } finally { setLoading(false); } }; const filteredEmployees = employees.filter(employee => { const matchesSearch = employee.fullName.toLowerCase().includes(searchTerm.toLowerCase()) || employee.role.toLowerCase().includes(searchTerm.toLowerCase()) || employee.email.toLowerCase().includes(searchTerm.toLowerCase()); const matchesDepartment = departmentFilter === 'all' || employee.department === departmentFilter; const matchesTier = tierFilter === 'all' || employee.securityTier.tierId.toString() === tierFilter; return matchesSearch && matchesDepartment && matchesTier; }); const departments = Array.from(new Set(employees.map(emp => emp.department).filter(Boolean))); if (loading) { return ( <div className="flex items-center justify-center min-h-96"> <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div> </div> ); } return ( <div className="space-y-6"> {/* Header */} <div className="bg-gradient-to-r from-blue-600 to-blue-800 text-white p-6 rounded-lg"> <div className="flex items-center gap-4"> <Users className="h-8 w-8" /> <div> <h1 className="text-3xl font-bold">SFG Aluminium Employee Directory</h1> <p className="text-blue-100 mt-2"> Complete organizational hierarchy with security tiers and color-coded scheduling </p> </div> </div> <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mt-6"> <div className="bg-blue-700/50 p-4 rounded-lg"> <div className="text-2xl font-bold">{employees.length}</div> <div className="text-blue-100">Total Employees</div> </div> <div className="bg-blue-700/50 p-4 rounded-lg"> <div className="text-2xl font-bold">{securityTiers.length}</div> <div className="text-blue-100">Security Tiers</div> </div> <div className="bg-blue-700/50 p-4 rounded-lg"> <div className="text-2xl font-bold">{departments.length}</div> <div className="text-blue-100">Departments</div> </div> <div className="bg-blue-700/50 p-4 rounded-lg"> <div className="text-2xl font-bold">{scheduleColors.length}</div> <div className="text-blue-100">Color Codes</div> </div> </div> </div> <Tabs value={activeTab} onValueChange={setActiveTab}> <TabsList className="grid w-full grid-cols-4"> <TabsTrigger value="directory">Employee Directory</TabsTrigger> <TabsTrigger value="hierarchy">Organizational Chart</TabsTrigger> <TabsTrigger value="security">Security Tiers</TabsTrigger> <TabsTrigger value="colors">Schedule Colors</TabsTrigger> </TabsList> {/* Employee Directory Tab */} <TabsContent value="directory" className="space-y-6"> {/* Filters */} <Card> <CardHeader> <CardTitle className="flex items-center gap-2"> <Filter className="h-5 w-5" /> Filters & Search </CardTitle> </CardHeader> <CardContent> <div className="grid grid-cols-1 md:grid-cols-4 gap-4"> <div className="relative"> <Search className="h-4 w-4 absolute left-3 top-3 text-gray-400" /> <Input placeholder="Search employees..." value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} className="pl-10" /> </div> <Select value={departmentFilter} onValueChange={setDepartmentFilter}> <SelectTrigger> <SelectValue placeholder="All Departments" /> </SelectTrigger> <SelectContent> <SelectItem value="all">All Departments</SelectItem> {departments.map(dept => dept && ( <SelectItem key={dept} value={dept}>{dept}</SelectItem> ))} </SelectContent> </Select> <Select value={tierFilter} onValueChange={setTierFilter}> <SelectTrigger> <SelectValue placeholder="All Security Tiers" /> </SelectTrigger> <SelectContent> <SelectItem value="all">All Security Tiers</SelectItem> {securityTiers.map(tier => ( <SelectItem key={tier.id} value={tier.tierId.toString()}> {tier.tierName} </SelectItem> ))} </SelectContent> </Select> <div className="text-sm text-gray-600 flex items-center"> Showing {filteredEmployees.length} of {employees.length} employees </div> </div> </CardContent> </Card> {/* Employee Cards */} <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"> {filteredEmployees.map((employee) => { const SecurityIcon = getSecurityTierIcon(employee.securityTier.tierId); return ( <Card key={employee.id} className="hover:shadow-lg transition-shadow"> <CardHeader className="pb-4"> <div className="flex items-start justify-between"> <div className="flex items-center gap-3"> <Avatar className="h-12 w-12"> <AvatarFallback className="text-lg font-semibold" style={{ backgroundColor: employee.scheduleColor?.colorCode || '#6b7280', color: 'white' }} > {employee.firstName.charAt(0)}{employee.lastName.charAt(0)} </AvatarFallback> </Avatar> <div> <h3 className="font-semibold text-lg">{employee.fullName}</h3> <p className="text-gray-600 text-sm">{employee.role}</p> </div> </div> {employee.scheduleNickname && ( <Badge variant="outline" style={{ backgroundColor: employee.scheduleColor?.colorCode + '20', borderColor: employee.scheduleColor?.colorCode, color: employee.scheduleColor?.colorCode }} > {employee.scheduleNickname} </Badge> )} </div> </CardHeader> <CardContent className="space-y-4"> {/* Security Tier */} <div className="flex items-center gap-2"> <SecurityIcon className="h-4 w-4" /> <Badge className={getSecurityTierColor(employee.securityTier.tierId)}> {employee.securityTier.tierName} </Badge> </div> {/* Contact Info */} <div className="space-y-2"> <div className="flex items-center gap-2 text-sm"> <Mail className="h-4 w-4 text-gray-400" /> <span className="truncate">{employee.email}</span> </div> {employee.phone && ( <div className="flex items-center gap-2 text-sm"> <Phone className="h-4 w-4 text-gray-400" /> <span>{employee.phone}</span> </div> )} {employee.department && ( <div className="flex items-center gap-2 text-sm"> <Building className="h-4 w-4 text-gray-400" /> <span>{employee.department}</span> </div> )} </div> {/* Skills */} {employee.skills.length > 0 && ( <div> <p className="text-sm font-medium text-gray-700 mb-2">Skills</p> <div className="flex flex-wrap gap-1"> {employee.skills.slice(0, 3).map((skill, index) => ( <Badge key={index} variant="secondary" className="text-xs"> {skill} </Badge> ))} {employee.skills.length > 3 && ( <Badge variant="secondary" className="text-xs"> +{employee.skills.length - 3} more </Badge> )} </div> </div> )} {/* Management Info */} {employee.manager && ( <div className="text-sm"> <span className="text-gray-500">Reports to: </span> <span className="font-medium">{employee.manager.fullName}</span> </div> )} {employee.directReports.length > 0 && ( <div className="text-sm"> <span className="text-gray-500">Manages: </span> <span className="font-medium">{employee.directReports.length} team members</span> </div> )} {/* Access Details */} {employee.accessDetails && ( <div className="text-xs text-gray-600 bg-gray-50 p-2 rounded"> <Shield className="h-3 w-3 inline mr-1" /> {employee.accessDetails} </div> )} </CardContent> </Card> ); })} </div> </TabsContent> {/* Security Tiers Tab */} <TabsContent value="security" className="space-y-6"> <div className="grid gap-6"> {securityTiers.map((tier) => { const employeesInTier = employees.filter(emp => emp.securityTier.tierId === tier.tierId); const SecurityIcon = getSecurityTierIcon(tier.tierId); return ( <Card key={tier.id}> <CardHeader> <div className="flex items-center gap-3"> <SecurityIcon className="h-6 w-6" /> <div> <CardTitle className="flex items-center gap-2"> {tier.tierName} <Badge className={getSecurityTierColor(tier.tierId)}> Tier {tier.tierId} </Badge> </CardTitle> <CardDescription>{tier.description}</CardDescription> </div> </div> </CardHeader> <CardContent> <div className="grid md:grid-cols-2 gap-6"> {/* Permissions */} <div> <h4 className="font-medium mb-3">Permissions & Access</h4> <div className="space-y-2"> <div className="flex items-center justify-between"> <span className="text-sm">Full System Access</span> <Badge variant={tier.hasFullSystemAccess ? "default" : "secondary"}> {tier.hasFullSystemAccess ? "Yes" : "No"} </Badge> </div> <div className="flex items-center justify-between"> <span className="text-sm">Financial Access</span> <Badge variant={tier.hasFinancialAccess ? "default" : "secondary"}> {tier.hasFinancialAccess ? "Yes" : "No"} </Badge> </div> <div className="flex items-center justify-between"> <span className="text-sm">Can Approve Quotes</span> <Badge variant={tier.canApproveQuotes ? "default" : "secondary"}> {tier.canApproveQuotes ? "Yes" : "No"} </Badge> </div> <div className="flex items-center justify-between"> <span className="text-sm">Can Manage Schedule</span> <Badge variant={tier.canManageSchedule ? "default" : "secondary"}> {tier.canManageSchedule ? "Yes" : "No"} </Badge> </div> {tier.maxApprovalValue && ( <div className="flex items-center justify-between"> <span className="text-sm">Max Approval Value</span> <Badge variant="outline"> Â£{tier.maxApprovalValue.toLocaleString()} </Badge> </div> )} </div> </div> {/* Employees */} <div> <h4 className="font-medium mb-3"> Employees ({employeesInTier.length}) </h4> <div className="space-y-2"> {employeesInTier.map(emp => ( <div key={emp.id} className="flex items-center gap-2 p-2 bg-gray-50 rounded"> <Avatar className="h-8 w-8"> <AvatarFallback className="text-xs"> {emp.firstName.charAt(0)}{emp.lastName.charAt(0)} </AvatarFallback> </Avatar> <div className="flex-1 min-w-0"> <p className="text-sm font-medium truncate">{emp.fullName}</p> <p className="text-xs text-gray-600 truncate">{emp.role}</p> </div> {emp.scheduleNickname && ( <Badge variant="outline" className="text-xs" style={{ backgroundColor: emp.scheduleColor?.colorCode + '20', borderColor: emp.scheduleColor?.colorCode }} > {emp.scheduleNickname} </Badge> )} </div> ))} </div> </div> </div> </CardContent> </Card> ); })} </div> </TabsContent> {/* Schedule Colors Tab */} <TabsContent value="colors" className="space-y-6"> <Card> <CardHeader> <CardTitle>Color-Coded Scheduling System</CardTitle> <CardDescription> Visual color assignment system for instant job and responsibility identification </CardDescription> </CardHeader> <CardContent> <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-4"> {scheduleColors.map((color) => ( <Card key={color.id} className="border-2" style={{ borderColor: color.colorCode }}> <CardContent className="p-4"> <div className="flex items-center gap-3 mb-3"> <div className="w-8 h-8 rounded-full border-2 border-white shadow-md" style={{ backgroundColor: color.colorCode }} ></div> <div> <h4 className="font-semibold">{color.colorName}</h4> <p className="text-sm text-gray-600">{color.staffNickname}</p> </div> </div> {color.assignedEmployee ? ( <div className="space-y-2"> <div className="flex items-center gap-2"> <Avatar className="h-8 w-8"> <AvatarFallback style={{ backgroundColor: color.colorCode, color: 'white' }} className="text-xs" > {color.assignedEmployee.fullName.split(' ').map(n => n.charAt(0)).join('')} </AvatarFallback> </Avatar> <div> <p className="text-sm font-medium">{color.assignedEmployee.fullName}</p> <p className="text-xs text-gray-600">{color.assignedEmployee.role}</p> </div> </div> <div className="text-xs text-gray-600"> Priority Level: {color.priorityLevel}/5 </div> </div> ) : ( <div className="text-sm text-gray-500 italic"> No employee assigned </div> )} </CardContent> </Card> ))} </div> </CardContent> </Card> </TabsContent> {/* Hierarchy Tab */} <TabsContent value="hierarchy" className="space-y-6"> <Card> <CardHeader> <CardTitle>Organizational Hierarchy</CardTitle> <CardDescription> Management structure and reporting relationships </CardDescription> </CardHeader> <CardContent> <div className="space-y-6"> {/* Top Level Management */} <div> <h3 className="text-lg font-semibold mb-4 text-red-800">Senior Management</h3> <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-4"> {employees .filter(emp => emp.securityTier.tierId === 1) .map(emp => ( <Card key={emp.id} className="border-red-200"> <CardContent className="p-4 text-center"> <Avatar className="h-12 w-12 mx-auto mb-2"> <AvatarFallback className="bg-red-100 text-red-800"> {emp.firstName.charAt(0)}{emp.lastName.charAt(0)} </AvatarFallback> </Avatar> <h4 className="font-semibold">{emp.fullName}</h4> <p className="text-sm text-gray-600">{emp.role}</p> {emp.directReports.length > 0 && ( <p className="text-xs text-gray-500 mt-1"> Manages {emp.directReports.length} reports </p> )} </CardContent> </Card> ))} </div> </div> {/* Department Managers */} <div> <h3 className="text-lg font-semibold mb-4 text-yellow-800">Department Managers</h3> <div className="grid md:grid-cols-2 lg:grid-cols-5 gap-4"> {employees .filter(emp => emp.securityTier.tierId === 3) .map(emp => ( <Card key={emp.id} className="border-yellow-200"> <CardContent className="p-4 text-center"> <Avatar className="h-10 w-10 mx-auto mb-2"> <AvatarFallback className="bg-yellow-100 text-yellow-800"> {emp.firstName.charAt(0)}{emp.lastName.charAt(0)} </AvatarFallback> </Avatar> <h4 className="font-medium text-sm">{emp.fullName}</h4> <p className="text-xs text-gray-600">{emp.role}</p> <p className="text-xs text-gray-500">{emp.department}</p> </CardContent> </Card> ))} </div> </div> {/* Team Leaders */} <div> <h3 className="text-lg font-semibold mb-4 text-blue-800">Team Leaders</h3> <div className="grid md:grid-cols-3 lg:grid-cols-5 gap-4"> {employees .filter(emp => emp.securityTier.tierId === 4) .map(emp => ( <Card key={emp.id} className="border-blue-200"> <CardContent className="p-3 text-center"> <Avatar className="h-8 w-8 mx-auto mb-2"> <AvatarFallback className="bg-blue-100 text-blue-800 text-xs"> {emp.firstName.charAt(0)}{emp.lastName.charAt(0)} </AvatarFallback> </Avatar> <h4 className="font-medium text-xs">{emp.fullName}</h4> <p className="text-xs text-gray-600">{emp.role}</p> </CardContent> </Card> ))} </div> </div> </div> </CardContent> </Card> </TabsContent> </Tabs> </div> ); } 